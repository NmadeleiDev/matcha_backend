(this["webpackJsonpfront-react"]=this["webpackJsonpfront-react"]||[]).push([[0],{178:function(e,t,a){e.exports=a(258)},189:function(e,t,a){},258:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(19),i=a.n(c),o=a(23),l=a(5),s=(a(189),a(9)),u=a(25),m=a(363),d=a(309),f=a(362),p=a(308),g="#fafafa",h="#fdfdfd",b={light:"#A8DADC",main:"#457B9D",dark:"#1D3557",contrastText:"#000",contrastTextLighter:"#777"},v={light:"#E94957",main:"#E63946",dark:"#C81927",contrastText:"#fff"},E=Object(p.a)({palette:{primary:b,secondary:v,info:{main:"#04728B"}},overrides:{MuiTextField:{root:{width:"100%"}},MuiContainer:{root:{display:"flex",justifyContent:"center"}},MuiBadge:{anchorOriginTopRightCircle:{top:"23%",right:"33%",transform:"scale(1.5) translate(50%, -50%)",border:"1px solid ".concat(h)}}},shape:{borderRadius:"30px"},props:{MuiButton:{variant:"outlined",color:"primary",size:"large"},MuiTextField:{variant:"outlined"},MuiAlert:{elevation:6,variant:"filled"}}}),y=a(8),x=a.n(y),O=a(13),j=a(311),w=a(320),k=a(266),C=a(28),S=Object(C.createSlice)({name:"login",initialState:{email:"",password:"",emailValid:!1,passwordValid:!1},reducers:{changeEmail:function(e,t){e.email=t.payload},changePassword:function(e,t){e.password=t.payload},changeEmailValid:function(e,t){var a=t.payload;e.emailValid=a},changePasswordValid:function(e,t){var a=t.payload;e.passwordValid=a}}}),N=S.actions,T=N.changeEmail,A=N.changePassword,L=N.changeEmailValid,I=N.changePasswordValid,U=S.reducer,D=a(16),V=a(55),M=a.n(V),B=M.a.CancelToken,F=M.a.create({baseURL:"/api/main/",withCredentials:!0,headers:{"Content-Type":"application/json"},validateStatus:function(e){return e>=200&&e<500}}),P=M.a.create({baseURL:"/api/media/",withCredentials:!0,headers:{"Content-Type":"application/json"},responseType:"blob",validateStatus:function(e){return e>=200&&e<500}}),R=M.a.create({baseURL:"/api/chat/",withCredentials:!0,headers:{"Content-Type":"application/json"},validateStatus:function(e){return e>=200&&e<500}}),W=function(){var e=Object(O.a)(x.a.mark((function e(t,a){var n,r,c,i=arguments;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>2&&void 0!==i[2]&&i[2],(r=new FormData).append("id",t),r.append("isAvatar",n),r.append("userImage",a),e.next=7,M.a.post("/api/media/upload/",r,{headers:{"Content-Type":"multipart/form-data"}});case 7:return c=e.sent,e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),_=a(10),z=function(e){return e?e.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&#34;"):""},G=function(e){var t=[/&lt;/g,"<"],a=[/&gt;/g,">"],n=[/&#39;/g,"'"],r=[/&#34;/g,'"'];return e?e.replace(t[0],t[1]).replace(a[0],a[1]).replace(n[0],n[1]).replace(r[0],r[1]):""},H=B.source(),$=function(){var e=Object(O.a)(x.a.mark((function e(t){var a,n,r,c,i;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=t.images)&&0!==a.length){e.next=3;break}return e.abrupt("return",Object(_.a)(Object(_.a)({},t),{},{images:[]}));case 3:return e.prev=3,n=a.map((function(e){return P("img/".concat(e),{cancelToken:H.token})})),e.next=7,Promise.allSettled(n);case 7:return r=e.sent,c=r.filter((function(e){return"fulfilled"===e.status})).map((function(e){var t=URL.createObjectURL(e.value.data);return{id:e.value.config.url.split("/")[1],image:t}})),(i=Object(_.a)(Object(_.a)({},t),{},{images:c})).avatar=i.images.find((function(e){return e.id===t.avatar})),e.abrupt("return",i);case 14:return e.prev=14,e.t0=e.catch(3),M.a.isCancel(e.t0)&&console.log("Request cancelled"),e.abrupt("return",t);case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}(),K=function(e){var t=(new Date).getFullYear()-new Date(e.birthDate).getFullYear();return Object(_.a)(Object(_.a)({},e),{},{age:t})},q=function(e){return e.map((function(e){return K(e)})).map((function(e){return $(e)}))},Y=a(28).createSlice,J={chat:null,chats:[]},Z=Y({name:"chat",initialState:J,reducers:{setChats:function(e,t){var a=t.payload;a&&a.length&&(e.chats=a.map((function(e){return Object(_.a)(Object(_.a)({},e),{},{messages:e.messages||[]})})))},addChat:function(e,t){var a=t.payload;e.chats.find((function(e){return e.id===a.id}))||e.chats.push(Object(_.a)(Object(_.a)({},a),{},{messages:a.messages||[]}))},deleteChat:function(e,t){var a,n=t.payload;e.chats=null===(a=e.chats)||void 0===a?void 0:a.filter((function(e){return e.id!==n.id}))},setChat:function(e,t){var a=t.payload;if(e.chats.length)if(a){var n=e.chats.find((function(e){return e.id===a.id}));e.chat=n?n.id:null}else e.chat=null},setChatByUserId:function(e,t){var a=t.payload;if(a&&0!==e.chats.length){var n=e.chats.find((function(e){return e.userIds.includes(a.id)}));e.chat=n&&n.id}},addMessage:function(e,t){var a=t.payload;if(a){var n=e.chats.findIndex((function(e){return e.id===a.chatId}));n<0||e.chats[n].messages.find((function(e){return e.id===a.id}))||e.chats[n].messages.push(a)}},updateMessage:function(e,t){var a,n=t.payload,r=e.chat||(null===(a=e.chats.find((function(e){return e.id===n.chatId})))||void 0===a?void 0:a.id);if(r){var c=e.chats.findIndex((function(e){return e.id===r})),i=e.chats[c].messages.findIndex((function(e){return e.id===n.id}));console.log("chatIdx: ".concat(c,", msgIdx: ").concat(i)),-1===i?e.chats[c].messages.push(n):(e.chats[c].messages[i].text=n.text,e.chats[c].messages[i].status=n.status)}},deleteMessage:function(e,t){var a,n=t.payload,r=e.chat||(null===(a=e.chats.find((function(e){return e.id===n.chatId})))||void 0===a?void 0:a.id),c=e.chats.findIndex((function(e){return e.id===r})),i=e.chats[c].messages.findIndex((function(e){return e.id===n.id}));-1!==i&&e.chat.messages.slpice(i,1)},upadateChatMessages:function(e,t){var a=t.payload;if(e.chat){var n=e.chats.findIndex((function(t){return t.id===e.chat}));e.chats[n].messages=a}},resetState:function(){return J}}}),X=Z.actions,Q=X.setChat,ee=X.setChats,te=X.setChatByUserId,ae=X.deleteChat,ne=X.addChat,re=(X.resetState,X.addMessage),ce=X.updateMessage,ie=X.deleteMessage,oe=(X.upadateChatMessages,Z.reducer),le={showBackButton:!1,header:null,selectedTab:null,companion:null,isInfoMissing:!1,parent:"/"},se=Object(C.createSlice)({name:"UI",initialState:le,reducers:{showBackButton:function(e){e.showBackButton=!0},hideBackButton:function(e){e.showBackButton=!1},setSelectedTab:function(e,t){var a=t.payload;e.selectedTab=a.selectedTab,e.header=a.selectedTab.label,e.companion=null},setHeader:function(e,t){var a=t.payload;e.header=a.header},resetUIState:function(){return le},setCompanion:function(e,t){var a=t.payload;e.companion=a.companion},setIsInfoMissing:function(e,t){var a=t.payload;e.isInfoMissing=a},setParent:function(e,t){var a=t.payload;e.parent=a.parent}}}),ue=se.actions,me=ue.showBackButton,de=ue.hideBackButton,fe=ue.setSelectedTab,pe=ue.setHeader,ge=ue.resetUIState,he=ue.setCompanion,be=ue.setIsInfoMissing,ve=ue.setParent,Ee=function(e,t){return function(a,n){var r=n().UI.parent;a(de()),a(pe({header:t})),a(he({companion:null})),a(Q(null)),"strangers"===r?e.push("/"):e.push("/".concat(r))}},ye=function(e){return function(t,a){try{F.post("/like",{id:e});var n=a().general.likes,r=[].concat(Object(D.a)(n),[e]);t(ja({likes:r}))}catch(c){console.log(c)}}},xe=function(e){return function(t,a){try{F.delete("/like/".concat(e));var n=a().general,r=n.likes,c=n.matches,i=n.likedBy,o=r.filter((function(t){return t!==e})),l=c.includes(e)?[].concat(Object(D.a)(i),[e]):i;t(ja({likes:o,likedBy:l}))}catch(s){console.log(s)}}},Oe=se.reducer,je=a(28).createSlice,we={username:"",city:"",country:"",gender:"",tags:[],age:{minAge:0,maxAge:100},rating:{min:0,max:1}},ke=je({name:"filter",initialState:we,reducers:{changeFilterState:function(e,t){var a=t.payload;for(var n in a)if(["username","city","country","gender","tags"].includes(n))e[n]="tags"===n?a[n].value:a[n];else if("age"===n)e.age.minAge=a.age[0],e.age.maxAge=a.age[1];else{if("rating"!==n)throw new Error("Key <<".concat(n,">> is not allowed"));e.rating.min=a.rating[0],e.rating.max=a.rating[1]}},resetFilter:function(e){Object(_.a)({},we)}}}),Ce=ke.actions,Se=Ce.changeFilterState,Ne=Ce.resetFilter,Te=ke.reducer,Ae=a(28).createSlice,Le={id:"",email:"",name:"",surname:"",username:"",bio:"",birthDate:0,gender:"",phone:"",country:"",city:"",maxDist:0,lookFor:"",minAge:0,maxAge:100,tags:null,useLocation:!1,emailValid:!1,usernameValid:!1,nameValid:!1,surnameValid:!1,bioValid:!1,countryValid:!1,cityValid:!1,updateSuccess:!1},Ie=Ae({name:"additional",initialState:Le,reducers:{setAdditionalState:function(e,t){var a=t.payload;Object.keys(a).forEach((function(t){if(["name","surname","bio","country","city"].includes(t)){var n=a[t]||Le[t];e[t]=G(n)}else e[t]=a[t]||Le[t]}))},resetAdditionalState:function(){return Le},changeEmail:function(e,t){var a=t.payload;e.email=a},changeUsername:function(e,t){var a=t.payload;e.username=a},changeName:function(e,t){var a=t.payload;e.name=a},changeSurname:function(e,t){var a=t.payload;e.surname=a},changeBio:function(e,t){var a=t.payload;e.bio=a},changeBirthDate:function(e,t){var a=t.payload,n=new Date(a).getTime();isNaN(n)||(e.birthDate=n)},changeGender:function(e,t){var a=t.payload;e.gender=a},changePhone:function(e,t){var a=t.payload;e.phone=a},changeCountry:function(e,t){var a=t.payload;e.country=a},changeCity:function(e,t){var a=t.payload;e.city=a},changeMaxDist:function(e,t){var a=t.payload;e.maxDist=+a},changeLookFor:function(e,t){var a=t.payload;e.lookFor=a},changeSearchAgeRange:function(e,t){var a=t.payload;e.minAge=a[0],e.maxAge=a[1]},changeMinAge:function(e,t){var a=t.payload;e.minAge=a},changeMaxAge:function(e,t){var a=t.payload;e.maxAge=a},changeTags:function(e,t){var a=t.payload.value;e.tags=a},changeUseLocation:function(e,t){var a=t.payload;e.useLocation=a},changeEmailValid:function(e,t){var a=t.payload;e.emailValid=a},changeUsernameValid:function(e,t){var a=t.payload;e.usernameValid=a},changeNameValid:function(e,t){var a=t.payload;e.nameValid=a},changeSurnameValid:function(e,t){var a=t.payload;e.surnameValid=a},changeBioValid:function(e,t){var a=t.payload;e.bioValid=a},changePhoneValid:function(e,t){var a=t.payload;e.phoneValid=a},changeCountryValid:function(e,t){var a=t.payload;e.countryValid=a},changeCityValid:function(e,t){var a=t.payload;e.cityValid=a},onUpdateSuccess:function(e){e.updateSuccess=!0},onUpdateFail:function(e){e.updateSuccess=!1}}}),Ue=Ie.actions,De=Ue.setAdditionalState,Ve=(Ue.resetAdditionalState,Ue.changeEmail),Me=Ue.changeUsername,Be=Ue.changeName,Fe=Ue.changeSurname,Pe=Ue.changeBio,Re=Ue.changeBirthDate,We=Ue.changeGender,_e=Ue.changePhone,ze=Ue.changeCountry,Ge=Ue.changeCity,He=Ue.changeMaxDist,$e=Ue.changeLookFor,Ke=Ue.changeSearchAgeRange,qe=Ue.changeTags,Ye=Ue.changeUseLocation,Je=Ue.changeEmailValid,Ze=Ue.changeUsernameValid,Xe=Ue.changeNameValid,Qe=Ue.changeSurnameValid,et=Ue.changeBioValid,tt=Ue.changePhoneValid,at=Ue.changeCountryValid,nt=Ue.changeCityValid,rt=Ue.onUpdateSuccess,ct=Ue.onUpdateFail,it=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.id,n=t.username,r=t.name,c=t.surname,i=t.bio,o=t.birthDate,l=t.phone,s=t.gender,u=t.country,m=t.city,d=t.maxDist,f=t.lookFor,p=t.minAge,g=t.maxAge,h=t.tags,b=t.useLocation,v=arguments.length>1?arguments[1]:void 0;return function(){var t=Object(O.a)(x.a.mark((function t(E,y){var O,j,w,k,C,S;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(O=y().additional,j=y().general,w={id:a||O.id,username:n||O.username,name:z(r)||O.name,surname:z(c)||O.surname,bio:z(i)||O.bio,phone:l||O.phone,birthDate:o||O.birthDate,gender:s||O.gender,country:z(u)||O.country,city:z(m)||O.city,maxDist:d||O.maxDist,lookFor:f||O.lookFor,minAge:p||O.minAge,maxAge:g||O.maxAge,useLocation:b||O.useLocation},0!==j.position.lat&&0!==j.position.lon&&(w.position=j.position),console.log("[AdditionalInfoSlice] update user info",O,j,w),w.id){t.next=8;break}return setTimeout((function(){return E(e(w))}),1e3),t.abrupt("return");case 8:return t.prev=8,O.email!==j.email&&F.put("email/change",{email:O.email}),t.next=12,F.put("account",w);case 12:if(C=t.sent,!h||!h.length){t.next=19;break}return t.next=16,F.put("tag",{tags:Object(D.a)(h)});case 16:S=t.sent,console.log("TAGS",S),S.data.status&&E(ja({tags:h}));case 19:if(console.log(C.data.data),!C.data.status){t.next=27;break}return E(ja(w)),E(rt()),v&&v("Successfully saved!","success"),t.abrupt("return");case 27:k=C.data;case 28:t.next=34;break;case 30:t.prev=30,t.t0=t.catch(8),console.log(t.t0),k="Server error";case 34:v&&v(k,"error"),E(ct());case 36:case"end":return t.stop()}}),t,null,[[8,30]])})));return function(e,a){return t.apply(this,arguments)}}()},ot=Ie.reducer,lt=a(54),st=a(62),ut=a(70),mt={CHAT:"CHAT",MESSAGE:"MESSAGE",UPDATE:"UPDATE"},dt={NEW_CHAT:"NEW_CHAT",DELETE_CHAT:"DELETE_CHAT"},ft={USER_STATUS_UPDATE:"USER_STATUS_UPDATE",NEW_LIKE:"NEW_LIKE",NEW_LOOK:"NEW_LOOK",NEW_MATCH:"NEW_MATCH",DELETE_MATCH:"DELETE_MATCH",DELETE_LIKE:"DELETE_LIKE"},pt={NEW:"UPDATE_STATUS_NEW",READ:"UPDATE_STATUS_READ"},gt={NEW_MESSAGE:"NEW_MESSAGE",UPDATE_MESSAGE:"UPDATE_MESSAGE",DELETE_MESSAGE:"DELETE_MESSAGE"},ht={STATUS_NEW:"STATUS_NEW",STATUS_DELIVERED:"STATUS_DELIVERED",STATUS_READ:"STATUS_READ"},bt=function e(t){var a=t.type,n=t.payload;Object(st.a)(this,e),this.type=a,this.payload=n||null},vt=function e(t){var a=t.id,n=t.userIds,r=t.messages;Object(st.a)(this,e),this.id=a||"",this.userIds=n,this.messages=r||[]},Et=function e(t){var a=t.id,n=t.sender,r=t.recipient,c=t.date,i=t.text,o=t.chatId,l=t.status;Object(st.a)(this,e),this.id=a||Object(ut.v4)(),this.chatId=o||"",this.sender=n,this.recipient=r,this.date=c||(new Date).getTime(),this.text=i||"",this.status=l},yt=function(){function e(t){var a=t.id,n=t.userId,r=t.type;Object(st.a)(this,e),this.id=a||Object(ut.v4)(),this.date=(new Date).getTime(),this.userId=n,this.type=r,this.status=pt.NEW}return Object(lt.a)(e,[{key:"equals",value:function(e){return this.id===e.id&&this.userId===e.userId&&this.type===e.type}}]),e}(),xt=(0,a(28).createSlice)({name:"snack",initialState:{notifications:[]},reducers:{addSnack:function(e,t){var a=t.payload;e.notifications.push(a)},dismissSnack:function(e,t){var a=t.payload;e.notifications=e.notifications.map((function(e){return a.dismissAll||e.key===a.key?Object(_.a)(Object(_.a)({},e),{},{dismissed:!0}):e}))},removeSnack:function(e,t){var a=t.payload;e.notifications=e.notifications.filter((function(e){return e.key!==a.key}))}}}),Ot=Object(_.a)({},xt.actions),jt=Ot.addSnack,wt=(Ot.dismissSnack,Ot.removeSnack),kt=xt.reducer,Ct={notifications:[]},St=Object(C.createSlice)({name:"WS",initialState:Ct,reducers:{resetWSSlice:function(){return Ct},addNotification:function(e,t){var a=t.payload;if(!a.notification)throw new Error("No notification in payload");if(!a.notification.id)throw new Error("No id in payload");e.notifications.length&&e.notifications.some((function(e){return e.id===a.notification.id&&e.userId===a.notification.userId&&e.type===a.notification.type}))||e.notifications.push(new yt(a.notification))},removeNotification:function(e,t){var a=t.payload;if(!a.notification)throw new Error("No notification in payload");if(!a.notification.id)throw new Error("No id in payload");var n=e.notifications.findIndex((function(e){return e.equals(a.notification)}));if(-1!==n)return e.notifications.filter((function(e,t){return t!==n}))},readNotification:function(e,t){var a=t.payload;if(!a.id)throw new Error("No id in payload");var n=e.notifications.findIndex((function(e){return e.id===a.id}));if(-1!==n){var r=e.notifications[n];r.status=pt.READ;var c=e.notifications.slice(0,n).concat(r).concat(e.notifications.slice(n+1));e.notifications=c}},readAllNotifications:function(e){e.notifications=e.notifications.map((function(e){return Object(_.a)(Object(_.a)({},e),{},{status:pt.READ})}))}}}),Nt=St.actions,Tt=(Nt.resetWSSlice,Nt.addNotification),At=(Nt.removeNotification,Nt.readNotification),Lt=Nt.readAllNotifications,It=St.reducer,Ut={isLoading:!1,isUpdating:!1,error:null,users:[],strangers:[],banned:null},Dt=new Set,Vt=Object(C.createSlice)({name:"users",initialState:Ut,reducers:{startLoading:function(e){e.isLoading=!0},successLoading:function(e){e.isLoading=!1},failLoading:function(e,t){var a=t.payload;e.isLoading=!1,e.error=a},addUsers:function(e,t){var a=t.payload,n=Object(D.a)(a);n.length&&n.forEach((function(t){0===Object.keys(t).length||e.users.find((function(e){return e.id===t.id}))||e.users.push(t)}))},updateUsers:function(e,t){var a=t.payload,n=Object(D.a)(a);n.length&&n.forEach((function(t){var a=e.users.find((function(e){return t.id===e.id}));a?Object.keys(t).forEach((function(e){"lastOnline"===e&&t[e]>a[e]||"isOnline"===e&&a[e]||(a[e]=t[e])})):e.users.push(t)}))},setUsersOnline:function(e,t){var a=t.payload,n=Object(D.a)(a);n.length&&n.forEach((function(t){var a=e.users.find((function(e){return t.id===e.id}));a&&(a.isOnline=t.isOnline)}))},sortStrangers:function(e,t){var a=t.payload,n=Object(_.a)({},a).compareFunction;e.strangers.sort(n)},updateStrangers:function(e,t){var a=t.payload,n=Object(D.a)(a);n.length&&n.forEach((function(t){var a=e.strangers.find((function(e){return t.id===e.id}));a&&Object.keys(t).forEach((function(e){a[e]=t[e]}))}))},setUsers:function(e,t){var a=t.payload;e.users=a},setStrangers:function(e,t){var a=t.payload;e.strangers=Object(D.a)(a)},setBanned:function(e,t){var a=t.payload;e.banned=a},startUpdating:function(e){e.isUpdating=!0},successUpdating:function(e){e.isUpdating=!1},failUpdating:function(e,t){var a=t.payload;e.isUpdating=!1,e.error=a},resetError:function(e){e.error=null},resetUsersState:function(){return Ut}}}),Mt=function(e){return e.map((function(e){return e.id}))},Bt=function(){var e=Object(O.a)(x.a.mark((function e(t){var a,n,r,c=arguments;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>1&&void 0!==c[1]?c[1]:{},n=Object.entries(a).reduce((function(e,t){var a=Object(s.a)(t,2),n=a[0],r=a[1];if("tags"===n){if(!r||0===r.length)return e;var c=r.reduce((function(e,t){return"".concat(t,",").concat(e)}));return e[n]=c,e}return"age"===n?Object(_.a)(Object(_.a)({},e),{},{minAge:r.minAge,maxAge:r.maxAge}):"gender"===n?("both"!==r&&(e[n]=r),e):(""!==r&&"username"!==n&&(e[n]=r),e)}),{}),e.prev=2,e.next=5,F.get("strangers",{params:n});case 5:if(!(r=e.sent).data.status){e.next=10;break}return e.abrupt("return",r.data.data||[]);case 10:if(t(r.data.data,"error"),"incorrect session id"!==r.data.data){e.next=13;break}return e.abrupt("return",null);case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),t("Server error","error"),console.log(e.t0);case 19:return e.abrupt("return",[]);case 20:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t){return e.apply(this,arguments)}}(),Ft=function(e,t){return function(){var a=Object(O.a)(x.a.mark((function a(n,r){var c,i,o,l,s;return x.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n(zt()),Wt(n),a.next=4,Bt(e,t);case 4:if(c=a.sent){a.next=10;break}return n(ha()),n(Qt()),n(ge()),a.abrupt("return");case 10:return n(Gt()),n(Zt()),c=c.map((function(e){return K(e)})),n(Jt(c)),n(Ht(c)),u=c,i=0===Dt.length?u:u.filter((function(e){return!Dt.has(e.id)})),a.next=18,Promise.all(q(i));case 18:o=a.sent,n(Kt(o)),l=r().users.users,s=c.map((function(e){return l.find((function(t){return t.id===e.id}))})).filter((function(e){return null!==e})),Mt(s).forEach((function(e){return Dt.add(e)})),n(Jt(s)),n(Xt());case 25:case"end":return a.stop()}var u}),a)})));return function(e,t){return a.apply(this,arguments)}}()},Pt=function(e){return function(){var t=Object(O.a)(x.a.mark((function t(a){var n,r,c,i,o,l;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return n=Object(D.a)(e).filter((function(e){return!Dt.has(e)})),t.prev=3,r=n.map((function(e){return F("/data/".concat(e))})),t.next=7,Promise.allSettled(r);case 7:return c=t.sent,i=c.filter((function(e){return"fulfilled"===e.status})).filter((function(e){return e.value.data.status})).map(function(){var e=Object(O.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$(t.value.data.data);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.next=11,Promise.all(i);case 11:if(o=t.sent,(l=o.map((function(e){return e&&K(e)}))).length){t.next=15;break}return t.abrupt("return");case 15:Mt(l).forEach((function(e){return Dt.add(e)})),a(Kt(l)),t.next=23;break;case 19:throw t.prev=19,t.t0=t.catch(3),console.log(t.t0),new Error("Fetching users failed");case 23:case"end":return t.stop()}}),t,null,[[3,19]])})));return function(e){return t.apply(this,arguments)}}()},Rt=function(e){return function(){var t=Object(O.a)(x.a.mark((function t(a,n){var r,c;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n().users.users,c=[],e.forEach((function(e){var t=r.find((function(t){return t.id===e.id}));t&&t.username||c.push(e.id)})),c.length&&a(Pt(c)),a(Kt(e)),a(qt(e));case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()},Wt=function(){var e=Object(O.a)(x.a.mark((function e(t){var a,n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F("ban");case 3:(a=e.sent).data.status&&(n=a.data.data||[],t(Pt(n)),t($t(n))),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),_t=Vt.actions,zt=_t.startLoading,Gt=_t.successLoading,Ht=_t.addUsers,$t=(_t.setUsers,_t.setBanned),Kt=_t.updateUsers,qt=_t.updateStrangers,Yt=(_t.setUsersOnline,_t.sortStrangers),Jt=_t.setStrangers,Zt=(_t.failLoading,_t.startUpdating),Xt=_t.successUpdating,Qt=(_t.failUpdating,_t.resetError,_t.resetUsersState),ea=Vt.reducer,ta=function(){var e=Object(l.b)();return{notif:function(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e(jt({key:Object(ut.v4)(),text:t.text||t,header:t.header,variant:a||"default",options:Object(_.a)(Object(_.a)({},n),{},{autoHideDuration:3e3})}))},handleNotification:function(t){if(console.log("[useNotifications] handleNotification",t),t.type===ft.NEW_LIKE||t.type===ft.NEW_LOOK||t.type===ft.NEW_MATCH||t.type===ft.DELETE_MATCH||t.type===ft.DELETE_LIKE){var a=new yt({type:t.type,userId:t.payload.userId});e(Tt({notification:a})),e(Rt([{id:t.payload.userId}]))}switch(t.type){case ft.NEW_LIKE:return console.log("[useNotifications] NEW_LIKE",t),void e(va({key:"likedBy",values:[t.payload.userId]}));case ft.NEW_LOOK:return void e(va({key:"lookedBy",values:[t.payload.userId]}));case ft.NEW_MATCH:return e(va({key:"matches",values:[t.payload.userId]})),void e(Ea({key:"likedBy",values:[t.payload.userId]}));case ft.DELETE_LIKE:return void e(Ea({key:"likedBy",values:[t.payload.userId]}));case ft.DELETE_MATCH:return void e(Ea({key:"matches",values:[t.payload.userId]}));default:return}},showPrompt:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e(jt({key:"message_"+Object(ut.v4)(),text:t.text||t,header:t.header,variant:"prompt",options:Object(_.a)(Object(_.a)({},a),{},{persist:!0})}))}}},aa=function(){var e=Object(l.c)((function(e){return e.general.id})),t=Object(l.b)(),a=Object(l.c)((function(e){return e.chat})).chat,n=ta().notif,r=Object(l.d)(),c=function(){var a=Object(O.a)(x.a.mark((function a(){var n;return x.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,R("chats",{params:{id:e}});case 3:(n=a.sent).data.status&&t(ee(n.data.data)),a.next=9;break;case 7:a.prev=7,a.t0=a.catch(0);case 9:case"end":return a.stop()}}),a,null,[[0,7]])})));return function(){return a.apply(this,arguments)}}(),i=function(){var t=Object(O.a)(x.a.mark((function t(a){var r,i;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new vt({userIds:[a,e]}),t.prev=1,t.next=4,R.post("chat",r);case 4:if(!(i=t.sent).data.status){t.next=8;break}return t.next=8,c();case 8:return t.abrupt("return",i.data.data);case 11:return t.prev=11,t.t0=t.catch(1),n("Server error when creating chat","error"),t.abrupt("return",null);case 15:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}();return{getChatsInfo:c,createChat:i,selectChat:function(e){t(te({id:e}))},handleChat:function(e){console.log("[hadleChat]",e),e.type===dt.NEW_CHAT?t(ne(e.payload)):e.type===dt.DELETE_CHAT&&t(ae(e.payload))},handleMessage:function(e){e.type===gt.NEW_MESSAGE?(t(re(e.payload)),function(e){var t,a=null===(t=r.getState().users)||void 0===t?void 0:t.users,c=window.location.pathname.match(e.chatId);if(!c||""===c[0]){var i=a&&a.find((function(t){return t.id===e.sender})),o=i?"".concat(i.username):"new message";n({header:o,text:e.text})}}(e.payload)):e.type===gt.UPDATE_MESSAGE?t(ce(e.payload)):e.type===gt.DELETE_MESSAGE&&t(ie(e.payload))},newMsg:function(t,n){var r=new Et({chatId:a,sender:e,recipient:t,text:n,status:ht.STATUS_NEW}),c=new bt({type:gt.NEW_MESSAGE,payload:r});la(mt.MESSAGE,c)},readMsg:function(e){var a=Object(_.a)(Object(_.a)({},e),{},{status:ht.STATUS_READ});t(ce(a));var n=new bt({type:gt.UPDATE_MESSAGE,payload:a});la(mt.MESSAGE,n)},updateMsg:function(e){var t=Object(_.a)(Object(_.a)({},e),{},{status:ht.STATUS_READ}),a=new bt({type:gt.UPDATE_MESSAGE,payload:t});la(mt.MESSAGE,a)}}},na=a(154),ra="ws://".concat("localhost",":").concat(8080),ca=null;localStorage.debug="*";var ia=function(e){return Object(na.io)(ra,{path:"/api/socket/connect",withCredentials:!0,reconnection:!1,query:{auth:e}})},oa=function(){var e=Object(l.c)((function(e){return e.general.id})),t=aa(),a=t.handleMessage,r=t.handleChat,c=ta().handleNotification,i=function(){var e=Object(l.d)(),t=Object(l.b)();return{getOnlineUsers:function(){var t,a=null===(t=e.getState().users)||void 0===t?void 0:t.users;return a?a.filter((function(e){return e.isOnline})):[]},updateOnline:function(a){var n=a.userId,r=a.isOnline,c={id:n,isOnline:r,lastOnline:(new Date).getTime()};t(Rt([c]));var i=e.getState().UI.companion;i&&i.id===n&&t(he({companion:Object(_.a)(Object(_.a)({},i),{},{isOnline:r})}))}}}().updateOnline;return Object(n.useEffect)((function(){(ca=ia(e)).on("connect",(function(){console.log("[open] \u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e"),ca.disconnected&&console.log("socket disconnected")})),ca.on(mt.CHAT,(function(e){var t=JSON.parse(e);r(t)})),ca.on(mt.MESSAGE,(function(e){var t=JSON.parse(e);a(t)})),ca.on(mt.UPDATE,(function(e){var t=JSON.parse(e);t.type===ft.USER_STATUS_UPDATE?i(t.payload):c(t)})),ca.onAny((function(e){console.log("got ".concat(e));for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];console.log(a)})),ca.on("disconnect",(function(e){console.log("[disconnect] ".concat(e)),"io client disconnect"!==e&&ca.connect()})),ca.on("close",(function(e){console.log("[close] ".concat(e))})),ca.on("error",(function(e){console.log(e),ca.connect()}))}),[]),ca},la=function(e,t){console.log(JSON.stringify(t)),ca.emit(e,JSON.stringify(t))},sa={isAuth:!1,isLoading:!1,id:"",email:"",phone:"",name:"",surname:"",username:"",bio:"",birthDate:0,gender:"",country:"",city:"",maxDist:0,lookFor:"",minAge:0,maxAge:0,images:[],avatar:null,useLocation:null,likedBy:[],matches:[],likes:[],position:{lat:0,lon:0}},ua=Object(C.createSlice)({name:"general",initialState:sa,reducers:{startLoading:function(e){e.isLoading=!0},stopLoading:function(e){e.isLoading=!1},authSuccess:function(e){e.isAuth=!0,e.isLoading=!1},authFail:function(e){e.isAuth=!1,e.isLoading=!1},resetGeneralState:function(e){return e.images&&e.images.forEach((function(e){return URL.revokeObjectURL(e.image)})),sa},setNewState:function(e,t){var a=t.payload;Object.keys(a).forEach((function(t){"position"===t?(a.position.lat&&(e.position.lat=a.position.lat),a.position.lon&&(e.position.lon=a.position.lon)):"images"===t&&a.images?e.images=Object(D.a)(a.images):["name","surname","bio","country","city"].includes(t)?e[t]=G(a[t]):e[t]=a[t]}))},addGeneralValues:function(e,t){var a=t.payload;if(console.log(a),!a.key||!a.values)throw new Error("[addGeneralValues] no key or value in payload");var n=e[a.key],r=[].concat(Object(D.a)(n),Object(D.a)(a.values));e[a.key]=Object(D.a)(new Set(r))},removeGeneralValues:function(e,t){var a=t.payload;if(console.log(a),!a.key||!a.values)throw new Error("[addGeneralValues] no key or value in payload");e[a.key]=e[a.key].filter((function(e){return!a.values.includes(e)}))||[]}}}),ma=ua.actions,da=ma.startLoading,fa=ma.stopLoading,pa=ma.authSuccess,ga=ma.authFail,ha=ma.resetGeneralState,ba=ma.setNewState,va=ma.addGeneralValues,Ea=ma.removeGeneralValues,ya=function(){var e=Object(O.a)(x.a.mark((function e(t,a){var n,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(ja(t.data)),a(pa()),a(De(t.data)),e.prev=3,e.next=6,Promise.resolve(q([t.data])[0]);case 6:return n=e.sent,e.next=9,F.get("like");case 9:r=e.sent,n.likes=r.data.status?r.data.data:[],n&&(a(ja(n)),a(De(n))),e.next=16;break;case 14:e.prev=14,e.t0=e.catch(3);case 16:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t,a){return e.apply(this,arguments)}}(),xa=function(e){var t=!1,a=!1;return Object.keys(e).forEach((function(n){-1===["tags","position","lookedBy","likedBy","matches","avatar","images","useLocation"].indexOf(n)&&("minAge"===n||"maxAge"===n?a=e.maxAge===sa.maxAge&&e.minAge===sa.minAge:t=t||e[n]===sa[n])})),t||a},Oa=function(){return function(){var e=Object(O.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t(da()),e.next=4,F("account");case 4:if(!(a=e.sent).data.status){e.next=10;break}return e.next=8,ya(a.data,t);case 8:e.next=11;break;case 10:t(ga());case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),t(ga());case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}()},ja=function(e){return function(t){var a=xa(e);t(be(a)),t(ba(e))}},wa=function(e,t,a){return function(){var n=Object(O.a)(x.a.mark((function n(r,c){var i,o,l,s;return x.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r(da()),i=c().general.position,n.prev=2,o={email:z(e),password:z(t)},i.lat&&(o.useLocation=!0),l=0===i.lat||0===i.lon?{}:{headers:{latitude:i.lat,longitude:i.lon}},n.next=8,F.post("/signin",o,l);case 8:(s=n.sent).data.status?ya(s.data,r):(r(ga()),r(ha()),a(s.data.data,"error")),n.next=16;break;case 12:n.prev=12,n.t0=n.catch(2),r(ga()),a("Server error","error");case 16:case"end":return n.stop()}}),n,null,[[2,12]])})));return function(e,t){return n.apply(this,arguments)}}()},ka=function(e){return function(){var t=Object(O.a)(x.a.mark((function t(a){var n;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a(da()),ca.disconnect(),t.prev=2,t.next=5,F.delete("/signout");case 5:if(!(n=t.sent).data.status){t.next=13;break}e("Successful logout","success"),a(ha()),a(ge()),a(Ne()),t.next=14;break;case 13:throw new Error(n.data.data);case 14:t.next=20;break;case 16:t.prev=16,t.t0=t.catch(2),a(fa()),e("Server error","error");case 20:case"end":return t.stop()}}),t,null,[[2,16]])})));return function(e){return t.apply(this,arguments)}}()},Ca=ua.reducer,Sa=a(3),Na=a(263),Ta=a(264),Aa=a(319),La=a(365),Ia=a(316),Ua=a(313),Da=a(314),Va=a(317),Ma=a(318),Ba=a(368),Fa=a(364),Pa=a(63),Ra=a(379),Wa=a(367),_a=Object(d.a)({Container:{width:"100%"}}),za=function(e){var t=_a(),a=function(){var e=Object(n.useState)([]),t=Object(s.a)(e,2),a=t[0],r=t[1],c=function(){var e=Object(O.a)(x.a.mark((function e(){var t,a,n,c=arguments;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:0,a=c.length>1&&void 0!==c[1]?c[1]:10,e.next=4,F("tag",{params:{offset:t,limit:a}});case 4:(n=e.sent).data.status&&n.data.data&&r(n.data.data);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){c()}),[]);return{tags:a,fetchTags:c,addTags:function(e){var t=new Set([].concat(Object(D.a)(a),Object(D.a)(e)));r(Object(D.a)(t))},removeTags:function(e){var t=a.filter((function(t){return!e.find((function(e){return e===t}))}));r(t)}}}().tags,c=Object(n.useState)([]),i=Object(s.a)(c,2),o=i[0],l=i[1];return Object(n.useEffect)((function(){l(a)}),[a]),r.a.createElement(j.a,{className:t.Container},o&&r.a.createElement(Wa.a,{multiple:!0,freeSolo:!0,id:e.name,options:o,getOptionLabel:function(e){return e},defaultValue:e.tags,value:e.tags,onChange:function(t,a,n){return e.onChange({value:a})},filterSelectedOptions:!0,renderInput:function(e){return r.a.createElement(La.a,Object.assign({},e,{variant:"outlined",label:"Tags",placeholder:"Enter tag and press enter"}))}}))},Ga=a(111),Ha=Object(d.a)({ButtonListItem:{justifyContent:"center"},Input:{width:"100%"},SmallSelector:{minWidth:"100px",padding:"10px"},FormControl:{width:"100%",display:"flex",flexDirection:"column",alignItems:"flex-start"},RadioGroup:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-evenly",alignItems:"center"}}),$a=function(e){var t=new Date(e),a=t.getFullYear();a<10?a="000"+a:a<100?a="00"+a:a<1e3?a="0"+a:a>3e3&&(a=3e3);var n=t.getMonth()+1;n=n<10?"0"+n:""+n;var r=t.getDate();return r=r<10?"0"+r:""+r,"".concat(a,"-").concat(n,"-").concat(r)},Ka=function(e){var t=Ha(),a=Object(_.a)({},e),c=a.type,i=a.label,o=a.name,l=a.values,u=a.value,m=a.onValidate,d=a.onChange,f=a.rules,p=a.ignoreUntouched,g=Object(Sa.a)(a,["type","label","name","values","value","onValidate","onChange","rules","ignoreUntouched"]),h=Object(n.useState)(!1),b=Object(s.a)(h,2),v=b[0],E=b[1],y=Object(n.useState)(!1),x=Object(s.a)(y,2),O=x[0],w=x[1],k=Object(n.useState)(""),C=Object(s.a)(k,2),S=C[0],N=C[1],T=f?Object(_.a)({},f):Object(_.a)({},{helperText:"",rule:null}),A=T.helperText,L=T.rule;switch(Object(n.useEffect)((function(){var e;e=!!L&&!function(e,t,a){return!a||e.length>=t.minLength&&e.length<=t.maxLength&&e.match(t.regex)}(u,L,p||v),N(e?A:""),m&&m((p||v)&&!e),w(e)}),[u,L,v,A,m,p]),c){case"text":case"number":case"email":case"password":return r.a.createElement(La.a,Object.assign({id:o,error:O,helperText:S,type:c,label:i,value:u,name:o,className:t.Input,onFocus:function(){return E(!0)},onChange:function(e){return d(e)}},g));case"select":return r.a.createElement(La.a,Object.assign({id:o,key:o,label:i,value:u,name:o,className:t.Input,onChange:function(e){return d(e)},select:!0},g),l.map((function(e){return r.a.createElement(Ia.a,{key:e,value:e},e)})));case"radio":return r.a.createElement(Ua.a,{className:t.FormControl,key:o,component:"fieldset"},r.a.createElement(Da.a,{component:"legend"},Object(Ga.capitalize)(i)),r.a.createElement(Va.a,{className:t.RadioGroup,value:u,"aria-label":o,name:o,onChange:function(e){return d(e)}},l.map((function(e){return r.a.createElement(Ma.a,{key:e,value:e,control:r.a.createElement(Ba.a,{checked:u===e,color:"primary"}),label:Object(Ga.capitalize)(e)})}))));case"date":return r.a.createElement(La.a,Object.assign({id:o,type:"date",label:"Birth Date",name:o,className:t.Input,InputLabelProps:{shrink:!0},value:$a(u),onChange:function(e){return d(e)}},g));case"slider":return r.a.createElement(Fa.a,{className:t.Input},r.a.createElement(Pa.a,{id:"range-slider",gutterBottom:!0},i),r.a.createElement(Ra.a,Object.assign({value:u,onChange:function(e,t){return d(t)},valueLabelDisplay:"auto","aria-labelledby":"range-slider"},g)));case"doubleSelector":return r.a.createElement(Fa.a,{key:o,className:t.Input},r.a.createElement(j.a,{container:!0,justify:"space-evenly",alignItems:"center"},r.a.createElement(j.a,{item:!0,xs:4},r.a.createElement(La.a,Object.assign({shrink:!0,id:"min"+o,type:"number",value:u.minAge,label:"Minimum age",className:t.SmallSelector,onChange:function(e){return d({minAge:+e.target.value})}},g))),r.a.createElement(j.a,{item:!0,xs:4},r.a.createElement(La.a,Object.assign({shrink:!0,id:"max"+o,type:"number",value:u.maxAge,label:"Maximum age",className:t.SmallSelector,onChange:function(e){return d({maxAge:+e.target.value})}},g)))));case"autocomplete":return r.a.createElement(za,Object.assign({name:o,className:t.Input,tags:l,onChange:d},g));default:return null}},qa=Object(d.a)({Form:{width:"100%"},Button:{margin:"8px"},List:{width:"100%"},Buttons:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},Fab:{position:"fixed",right:"10vw",bottom:"4rem",zIndex:2}}),Ya=function(e){var t=e.inputs,a=e.buttons,n=qa();return r.a.createElement("form",{className:n.Form},r.a.createElement(Na.a,{className:n.List},t.map((function(e){return r.a.createElement(Ta.a,{key:e.name||e.type},r.a.createElement(Ka,e))})),a&&r.a.createElement(Ta.a,{className:n.Buttons},a.map((function(e){var t=e.component,a=e.variant,c=e.type,i=e.text,o=e.onClick,l=Object(Sa.a)(e,["component","variant","type","text","onClick"]);return"fab"===t?r.a.createElement(Aa.a,Object.assign({color:"primary",key:i,className:n.Fab,variant:a,type:c,onClick:o},l),i):r.a.createElement(k.a,Object.assign({key:i,className:n.Button,variant:a,type:c,onClick:o},l),i)})))))},Ja=a(11),Za=Object(d.a)((function(e){var t;return{SingleForm:(t={width:"70vw",height:"100vh",margin:"0 auto"},Object(Ja.a)(t,e.breakpoints.down("xs"),{width:"100vw"}),Object(Ja.a)(t,e.breakpoints.up("md"),{maxWidth:"600px !important"}),t),label:{textTransform:"none"}}})),Xa=function(){var e=ta().notif,t=Za(),a=Object(u.g)(),c=Object(l.b)(),i=Object(l.c)((function(e){return e.login})),o=i.email,m=i.password,d=i.emailValid,f=i.passwordValid,p=Object(l.c)((function(e){return e.general})).isLoading,g=Object(n.useState)(!0),h=Object(s.a)(g,2),b=h[0],v=h[1];Object(n.useEffect)((function(){v(d&&f)}),[d,f]);var E=function(){var t=Object(O.a)(x.a.mark((function t(a){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault(),c(wa(o,m,e));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),y=[{name:"email",type:"email",label:"Email",value:o,onValidate:function(e){c(L(e))},onChange:function(e){c(T(e.target.value))},rules:{helperText:"invalid email",rule:{minLength:3,maxLength:40,regex:/^([\w%+-.]+)@([\w-]+\.)+([\w]{2,})$/i}}},{name:"password",type:"password",label:"Password",value:m,required:!0,onValidate:function(e){c(I(e))},onChange:function(e){c(A(e.target.value))},rules:{helperText:"Use at least one lower- and uppercase letter, number and symbol. Min length 4",rule:{minLength:4,maxLength:20,regex:/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[-+_!@#$%^&*.,?]).{4,}$/}}}],C=[{variant:"contained",type:"submit",text:"Sign in",disabled:!b,onClick:function(e){E(e)}},{text:"Not yet with us?",onClick:function(){a.push("register")}}];return r.a.createElement(j.a,{container:!0,justify:"center",alignItems:"center",direction:"column",className:t.SingleForm},p?r.a.createElement(w.a,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(Ya,{inputs:y,buttons:C}),r.a.createElement(k.a,{variant:"text",color:"primary",classes:{label:t.label},onClick:function(){a.push("/forgot")}},"Forgot password?")))},Qa={email:"",username:"",password:"",confirm:"",emailValid:!1,usernameValid:!1,passwordValid:!1,confirmValid:!1,phoneValid:!1,registerSuccess:!1},en=Object(C.createSlice)({name:"register",initialState:Qa,reducers:{changeEmail:function(e,t){var a=t.payload;e.email=a},changeUsername:function(e,t){var a=t.payload;e.username=a},changePassword:function(e,t){var a=t.payload;e.password=a},changeConfirmPassword:function(e,t){var a=t.payload;e.confirm=a},changeEmailValid:function(e,t){var a=t.payload;e.emailValid=a},changeUsernameValid:function(e,t){var a=t.payload;e.usernameValid=a},changePasswordValid:function(e,t){var a=t.payload;e.passwordValid=a},changeConfirmValid:function(e,t){var a=t.payload;e.confirmValid=a},onRegisterSuccess:function(e){Object(_.a)(Object(_.a)({},Qa),{},{registerSuccess:!0})},onRegisterFail:function(e){e.registerSuccess=!1}}}),tn=en.actions,an=tn.changeEmail,nn=tn.changeUsername,rn=tn.changePassword,cn=tn.changeConfirmPassword,on=tn.changeEmailValid,ln=tn.changeUsernameValid,sn=tn.changePasswordValid,un=tn.changeConfirmValid,mn=(tn.changePhoneValid,tn.onRegisterSuccess),dn=(tn.onRegisterFail,function(e,t,a,n,r){return function(){var c=Object(O.a)(x.a.mark((function c(i){var o,l;return x.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return i(da()),o={username:z(e),email:z(t),password:z(a)},c.prev=2,c.next=5,F.post("signup",o);case 5:!0===(l=c.sent).data.status?(i(mn()),n("Account successfully created, now login","success"),r.push("/login")):n(l.data.data,"error"),c.next=13;break;case 9:c.prev=9,c.t0=c.catch(2),console.log(c.t0),n("server error","error");case 13:i(fa());case 14:case"end":return c.stop()}}),c,null,[[2,9]])})));return function(e){return c.apply(this,arguments)}}()}),fn=en.reducer,pn=function(){var e=ta().notif,t=Object(l.b)(),a=Za(),c=Object(u.g)(),i=Object(l.c)((function(e){return e.register})),o=i.email,m=i.username,d=i.password,f=i.confirm,p=i.emailValid,g=i.usernameValid,h=i.passwordValid,b=i.confirmValid,v=Object(n.useState)(!1),E=Object(s.a)(v,2),y=E[0],k=E[1],C=Object(l.c)((function(e){return e.general})).isLoading;Object(n.useEffect)((function(){k(p&&g&&h&&b)}),[p,g,h,b]);var S=function(){var a=Object(O.a)(x.a.mark((function a(n){return x.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n.preventDefault(),t(dn(m,o,d,e,c));case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),N=[{name:"username",type:"text",label:"Username",value:m,required:!0,onValidate:function(e){t(ln(e))},onChange:function(e){t(nn(e.target.value))},rules:{helperText:"Use letters, numbers or symbols ., %, _, -, +. Min length 3",rule:{minLength:3,maxLength:20,regex:/^[\w%-+.]+$/}}},{name:"email",type:"email",label:"Email",value:o,required:!0,onValidate:function(e){t(on(e))},onChange:function(e){t(an(e.target.value))},rules:{helperText:"invalid email",rule:{minLength:3,maxLength:40,regex:/^([\w%+-.]+)@([\w-]+\.)+([\w]{2,})$/i}}},{name:"password",type:"password",label:"Password",value:d,required:!0,onValidate:function(e){t(sn(e))},onChange:function(e){t(rn(e.target.value))},rules:{helperText:"Use at least one lower- and uppercase letter, number and symbol. Min length 4",rule:{minLength:4,maxLength:20,regex:/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[-+_!@#$%^&*.,?]).{4,}$/}}},{name:"confirm",type:"password",label:"Confirm",value:f,required:!0,onValidate:function(e){t(un(e))},onChange:function(e){t(cn(e.target.value))},rules:{helperText:"Confirm and password does not match",rule:{minLength:3,maxLength:20,regex:new RegExp("^".concat(d,"$"))}}}],T=[{variant:"contained",type:"submit",text:"Sign up",disabled:!y,onClick:function(e){S(e)}},{text:"Already a member?",onClick:function(){c.push("/login")}}];return r.a.createElement(j.a,{container:!0,justify:"center",alignItems:"center",direction:"column",className:a.SingleForm},C?r.a.createElement(w.a,null):r.a.createElement(Ya,{inputs:N,buttons:T}))},gn=a(346),hn=a(331),bn=a(348),vn=a(366),En=a(354),yn=a(355),xn=a(356),On=a(357),jn=a(358),wn=a(322),kn=a(323),Cn=a(376),Sn=a(326),Nn=a(330),Tn=a(324),An=a(325),Ln=a(327),In=a(328),Un=a(329),Dn=a(31),Vn=a.n(Dn),Mn=a(32),Bn=a.n(Mn),Fn=function(){var e=Object(O.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F.post("ban",{id:t});case 3:return a=e.sent,e.abrupt("return",a.data.status);case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),Pn=function(){var e=Object(O.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F.delete("ban/".concat(t));case 3:return a=e.sent,e.abrupt("return",a.data.status);case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),Rn=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.users})),a=t.strangers,n=t.banned,r=function(){var t=Object(O.a)(x.a.mark((function t(r){var c,i;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Fn(r);case 2:c=a.filter((function(e){return e.id!==r})),e(Jt(c)),i=[].concat(Object(D.a)(n),[r]),e($t(i));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),c=function(){var t=Object(O.a)(x.a.mark((function t(a){var r,c;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Pn(a);case 2:r=t.sent,n.length&&r&&(c=n.filter((function(e){return e!==a})),e($t(c)));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return{banned:n,banAndUpdate:r,unbanAndUpdate:c}},Wn=a(321),_n=Object(d.a)({UserCard:{maxWidth:350,minWidth:220,margin:"0 auto",position:"relative",overflow:"hidden","&:hover":{cursor:"pointer","& $Info":{transform:"translateY(-80px)"},"& $Fab":{opacity:1},"& $Stepper":{opacity:1}}},Info:{width:"105%",padding:"10px 30px 20px",position:"absolute",color:"white",left:-10,background:"linear-gradient(#00000000, #000000aa)",transition:"0.3s"},InfoHeader:{justifyContent:"space-between",padding:0,"& p":{fontSize:"1.5rem"}},Tags:{lineHeight:"0.5rem","& span":{fontSize:"1rem"},"& span:nth-child(n+2)::before":{content:'"|"',margin:"0 10px"}},Stepper:{backgroundColor:"#ffffff00",position:"absolute",width:"100%",transition:"0.3s",opacity:0},StepperButton:{backgroundColor:"#ffffff00",textShadow:"0,0,10,#00000055"},CardMedia:{height:0,paddingTop:"100%"},Fab:{position:"absolute",bottom:10,right:10,transition:"0.3s",opacity:0,zIndex:3},Like:{right:70},Ban:{right:10},Status:{position:"absolute",bottom:5,left:"50%",marginLeft:-20,width:40,height:5,borderRadius:3,backgroundColor:E.palette.grey[500]},Online:{backgroundColor:E.palette.success.main},Tooltip:{backgroundColor:E.palette.background.default,color:E.palette.grey[700],padding:20}}),zn={username:"",images:null,age:0,isOnline:!1},Gn=function(e){var t=_n(),a=Object(n.useState)(0),c=Object(s.a)(a,2),i=c[0],o=c[1],m=Object(_.a)({},e.user).id,d=Object(l.c)((function(e){return e.users.users})).find((function(e){return e.id===m})),f=d||zn,p=f.username,g=f.images,h=f.age,b=f.isOnline,v=e.user.tags,E=Object(u.g)(),y=Object(l.b)(),x=Rn().banAndUpdate,O=Object(l.c)((function(e){return e.general})).likes,w=Object(n.useState)(!1),C=Object(s.a)(w,2),S=C[0],N=C[1];Object(n.useEffect)((function(){N((function(){return O.includes(m)}))}),[O,m]);var T=0===(null===g||void 0===g?void 0:g.length)||i===(null===g||void 0===g?void 0:g.length)-1,A=0===i||0===(null===g||void 0===g?void 0:g.length);return r.a.createElement(j.a,{item:!0,xs:12,sm:6,lg:4},r.a.createElement(kn.a,{className:t.UserCard,onClick:function(t){y(he({companion:e.user})),y(function(e){return function(a){try{F.post("/look",{id:e})}catch(t){console.log(t)}}}(m)),y(ve({parent:"strangers"})),E.push("/strangers/"+m)}},r.a.createElement("div",null,g&&g.length>1&&r.a.createElement(Cn.a,{variant:"dots",steps:0,position:"static",activeStep:i,className:t.Stepper,nextButton:T?null:r.a.createElement(k.a,{color:"secondary",className:t.StepperButton,size:"small",onClick:function(e){e.stopPropagation(),o((function(e){return e+1}))}},r.a.createElement(Tn.a,null)),backButton:A?null:r.a.createElement(k.a,{color:"secondary",className:t.StepperButton,size:"small",onClick:function(e){e.stopPropagation(),o((function(e){return e-1}))}},r.a.createElement(An.a,null))}),g&&g.length>0&&r.a.createElement(Sn.a,{style:{tooltip:t.Tooltip},title:S?"Unlike user":"Like user","aria-label":S?"Unlike user":"Like user"},r.a.createElement(Aa.a,{color:"secondary",className:Bn()(t.Fab,t.Like),size:"small",onClick:function(e){return function(e){e.stopPropagation(),y(S?xe(m):ye(m))}(e)}},S?r.a.createElement(Ln.a,null):r.a.createElement(In.a,null))),r.a.createElement(Sn.a,{style:{tooltip:t.Tooltip},title:"Ban user","aria-label":"Ban user"},r.a.createElement(Aa.a,{color:"secondary",className:Bn()(t.Fab,t.Ban),size:"small",onClick:function(e){return function(e){e.stopPropagation(),x(m)}(e)}},r.a.createElement(Un.a,null))),function(){var e=Vn.a;if(g&&g.length){if(!g[i].image)return r.a.createElement(Wn.a,{variant:"rect",className:t.CardMedia});e=g[i].image}return r.a.createElement(wn.a,{className:t.CardMedia,image:e})}(),r.a.createElement("div",{className:b?Bn()(t.Status,t.Online):t.Status}),r.a.createElement(Nn.a,{className:t.Info},r.a.createElement(hn.a,{className:t.InfoHeader},r.a.createElement(Pa.a,null,p,", ",h)),r.a.createElement("div",{className:t.Tags},v?v.map((function(e){return r.a.createElement("span",{key:e},"#",e)})):r.a.createElement("span",null,"No tags"))))))},Hn=a(114),$n=a.n(Hn),Kn=a(156),qn=a.n(Kn),Yn=a(338),Jn=a(332),Zn=Object(d.a)({Card:{position:"relative",maxWidth:350,margin:"0 auto","&:hover":{"& $Media":{transform:"scale(1.2)"},"& $Fab":{opacity:1}}},Media:{paddingTop:"100%"},Grid:{marginTop:"10px"},Fab:{position:"absolute",bottom:"10px",right:"10px",transition:"0.3s",opacity:0,zIndex:4}}),Xn=function(e){var t=Zn(),a=Object(l.b)(),n=Object(l.c)((function(e){return e.general})),c=n.images,i=n.avatar;e.images&&(c=e.images);var o=ta().notif,s=function(){var t=Object(O.a)(x.a.mark((function t(n,r){var l,s,u;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.stopPropagation(),!e.images){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,t.next=6,P.delete("img/".concat(r),{responseType:"json"});case 6:l=t.sent,console.log(l),l.data.status&&(s=c.filter((function(e){return e.id!==r})),u=r===i.id?s[0]:i,console.log(s,u),a(ba({images:s,avatar:u}))),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(3),console.log(t.t0),o("Server error, try again later","error");case 15:case"end":return t.stop()}}),t,null,[[3,11]])})));return function(e,a){return t.apply(this,arguments)}}();return r.a.createElement(j.a,{className:t.Grid,container:!0,justify:"center",spacing:1},c.length>0?c.map((function(a){return r.a.createElement(j.a,{item:!0,xs:10,sm:6,md:4,key:a.id||a},r.a.createElement(kn.a,{className:t.Card},!e.images&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Aa.a,{color:"secondary",className:t.Fab,size:"small",onClick:function(e){return s(e,a.id)}},r.a.createElement(Jn.a,null))),r.a.createElement(wn.a,{className:t.Media,image:a.image||Vn.a})))})):r.a.createElement(Pa.a,null,"No images"))},Qn=a(375),er=Object(d.a)({Item:{margin:"0 5px"},Header:{fontSize:"1.3rem",fontWeight:500,display:"block"},Container:{width:"100%",padding:"0.5rem 0"}}),tr=function(e){var t=e.tags,a=er();return r.a.createElement(j.a,{container:!0,justify:"center",alignItems:"center"},r.a.createElement(j.a,{className:a.Container,container:!0,direction:"column",alignItems:"flex-start",item:!0},r.a.createElement(Pa.a,{className:a.Header},"Interests:"),r.a.createElement(j.a,null,t?t.map((function(e){return r.a.createElement(Qn.a,{className:a.Item,variant:"outlined",key:e,label:e})})):r.a.createElement(Pa.a,null,"No tags yet"))))},ar=Object(d.a)({Card:{width:"100%",maxHeight:200},Media:{paddingTop:"30%"}}),nr=function(e){var t=e.img,a=ar();return r.a.createElement(kn.a,{className:a.Card},r.a.createElement(wn.a,{className:a.Media,image:t||Vn.a}))},rr=Object(d.a)({Item:{padding:"10px 15px",width:"100%"},Header:{fontSize:"1.3rem",fontWeight:500,display:"block"},Container:{width:"100%",padding:"0.5rem 0"},fullWidth:{width:"100%"}}),cr=function(e){var t=e.bio,a=rr();return r.a.createElement(j.a,{container:!0,justify:"center",alignItems:"center"},r.a.createElement(j.a,{className:a.Container,container:!0,direction:"column",alignItems:"flex-start",item:!0},r.a.createElement(Pa.a,{className:a.Header},"Bio:"),r.a.createElement(j.a,{className:a.fullWidth},r.a.createElement(Qn.a,{className:a.Item,label:t,variant:"outlined"}))))},ir=a(339),or=a(340),lr=a(71),sr=function(e){var t=e.colors,a=void 0===t?{elementColor:{main:"#89b0e0",shadow:"#6197d5"},ringColor:{main:"#99ddfc",shadow:"#66cdf7"}}:t,n=Object(Sa.a)(e,["colors"]);return r.a.createElement(lr.a,Object.assign({viewBox:"0 0 511 511"},n),r.a.createElement("path",{xmlns:"http://www.w3.org/2000/svg",d:"m465.029.009h-70.218c-21.163 0-38.477 17.315-38.477 38.477 0 15.974 9.868 29.748 23.808 35.544 2.544 1.058 3.228 4.333 1.279 6.281l-143.536 143.535 49.261 49.26 143.536-143.536c1.948-1.948 5.223-1.265 6.281 1.279 5.796 13.94 19.57 23.808 35.544 23.808 21.163 0 38.478-17.315 38.477-38.477v-70.218c.672-26.836-18.806-45.953-45.955-45.953z",fill:a.elementColor.main}),r.a.createElement("path",{xmlns:"http://www.w3.org/2000/svg",d:"m301.028 160.703-63.143 63.143 49.261 49.26 62.107-62.108c-9.062-17.63-34.358-44.312-48.225-50.295z",fill:a.elementColor.shadow}),r.a.createElement("path",{xmlns:"http://www.w3.org/2000/svg",d:"m172.157 166.679c-95.08 0-172.157 77.077-172.157 172.156s77.077 172.157 172.157 172.157 172.157-77.077 172.157-172.157-77.078-172.156-172.157-172.156zm0 278.623c-58.8 0-106.466-47.667-106.466-106.466s47.667-106.466 106.466-106.466c58.8 0 106.466 47.667 106.466 106.466s-47.667 106.466-106.466 106.466z",fill:a.ringColor.main}),r.a.createElement("path",{xmlns:"http://www.w3.org/2000/svg",d:"m166.067 510.146c-10.713-22.493-19.376-45.941-26.316-69.873-42.953-13.71-74.061-53.938-74.061-101.438 0-45.748 28.857-84.752 69.359-99.816 1.911-7.469 3.992-14.898 6.242-22.279 3.69-12.108 7.948-24.071 13.413-35.503 2.329-4.871 4.904-9.746 7.926-14.293-90.647 4.945-162.63 80.009-162.63 171.891 0 93.162 74.002 169.028 166.428 172.052-.118-.248-.242-.493-.361-.741z",fill:a.ringColor.shadow}))},ur=function(e){var t=e.colors,a=void 0===t?{elementColor:{main:"#ef7d92",shadow:"#eb6773"},ringColor:{main:"#f6a7ae",shadow:"#f1919b"}}:t,n=Object(Sa.a)(e,["colors"]);return r.a.createElement(lr.a,Object.assign({viewBox:"0 0 511 511"},n),r.a.createElement("path",{xmlns:"http://www.w3.org/2000/svg",d:"m202.361 446.901h21.698v32.828c0 17.271 14.001 31.272 31.272 31.272 17.271 0 31.272-14.001 31.272-31.272v-32.828h22.037c14.985 0 27.133-12.148 27.133-27.133 0-14.985-12.148-27.133-27.133-27.133h-22.037v-98.818h-62.205l-.339 98.818h-21.698c-14.985 0-27.133 12.148-27.133 27.133 0 14.985 12.148 27.133 27.133 27.133z",fill:a.elementColor.main}),r.a.createElement("path",{xmlns:"http://www.w3.org/2000/svg",d:"m286.602 371.971v-74.042h-62.205l-.245 74.042c15.854 4.399 49.488 3.211 62.45 0z",fill:a.elementColor.shadow}),r.a.createElement("path",{xmlns:"http://www.w3.org/2000/svg",d:"m255.5 0c-95.136 0-172.259 77.123-172.259 172.259s77.123 172.259 172.259 172.259 172.259-77.123 172.259-172.259-77.123-172.259-172.259-172.259zm0 278.789c-58.835 0-106.53-47.695-106.53-106.53s47.695-106.53 106.53-106.53 106.53 47.695 106.53 106.53-47.695 106.53-106.53 106.53z",fill:a.ringColor.main}),r.a.createElement("path",{xmlns:"http://www.w3.org/2000/svg",d:"m151.81 196.75c-1.851-7.864-2.84-16.061-2.84-24.49 0-58.835 47.695-106.53 106.53-106.53 8.385 0 16.541.978 24.367 2.81 23.675-14.885 48.337-28.117 74.948-37.027-28.069-19.844-62.326-31.513-99.315-31.513-95.136 0-172.259 77.123-172.259 172.259 0 42.205 15.187 80.858 40.383 110.812.493-1.003 7.644-48.436 28.186-86.321z",fill:a.ringColor.shadow}))},mr=a(372),dr=a(334),fr=a(335),pr=a(336),gr=a(337),hr=function(e){var t=e.open,a=e.onClose,c=Object(l.c)((function(e){return e.general.id})),i=Object(n.useState)({category:"",complaint:""}),o=Object(s.a)(i,2),u=o[0],m=o[1],d=Object(n.useState)(!1),f=Object(s.a)(d,2),p=f[0],g=f[1],h=Object(n.useState)(""),b=Object(s.a)(h,2),v=b[0],E=b[1],y=ta().notif,j=function(e){e.preventDefault(),m(Object(_.a)(Object(_.a)({},u),{},Object(Ja.a)({},e.target.name,e.target.value))),"category"===e.target.name&&e.target.value.length>0&&E("")},w=function(){var e=Object(O.a)(x.a.mark((function e(t){var n,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopPropagation(),0!==u.category.length){e.next=4;break}return E("Please, select category"),e.abrupt("return");case 4:return n={date:(new Date).getTime(),category:u.category,complaint:u.complaint,authorId:c},e.prev=5,e.next=8,F.post("report",n);case 8:if(!(r=e.sent).data.status){e.next=13;break}y("Report was successfully sent","success"),e.next=14;break;case 13:throw new Error(r.data.status||"Server error");case 14:a(),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),y(e.t0,"error");case 20:case"end":return e.stop()}}),e,null,[[5,17]])})));return function(t){return e.apply(this,arguments)}}(),C=[{name:"category",type:"select",label:"Category",value:u.category,values:["Unacceptable behavior","Bad language","Advertisement account"],ignoreUntouched:!0,onChange:j},{name:"complaint",type:"text",label:"Complaint",value:u.complaint,ignoreUntouched:!0,onChange:j,onValidate:function(e){return g(e)},rules:{helperText:"Invalid complaint. Min length: 5, max length: 40",rule:{minLength:3,maxLength:40,regex:/^.+$/i}}}];return r.a.createElement(mr.a,{style:{minWidth:400},open:t,onClose:a,"aria-labelledby":"form-report-user"},r.a.createElement(dr.a,{id:"form-report-user"},"Report user"),r.a.createElement(fr.a,null,r.a.createElement(pr.a,null,"Please give some description, why user is reported"),C.map((function(e){return r.a.createElement(Ka,Object.assign({style:{margin:"10px 0"},key:e.name},e))})),r.a.createElement(Pa.a,{style:{color:"red"}},v)),r.a.createElement(gr.a,null,r.a.createElement(k.a,{onClick:a},"Cancel"),r.a.createElement(k.a,{disabled:!p,onClick:w},"Submit")))};$n.a.extend(qn.a);var br=Object(d.a)((function(e){return{Typography:{fontSize:"1.5rem"},Name:{fontSize:"2rem",marginRight:10},Location:{fontSize:"1rem"},FullWidth:{width:"100%"},Message:{position:"fixed",right:"1rem",bottom:"8rem"},FabIcon:{marginRight:"10px"},Like:{position:"fixed",right:"1rem",bottom:"4rem"},Status:{position:"absolute",left:"50%",width:"50%",marginLeft:"-25%",height:5,borderRadius:3,backgroundColor:e.palette.grey[500]},Online:{backgroundColor:e.palette.success.main},Report:{marginTop:10}}})),vr=function(){var e,t=br(),a=Object(u.g)(),c=Object(l.c)((function(e){return e.UI.companion})),i=Object(_.a)({},c),o=i.id,m=i.images,d=i.avatar,f=i.gender,p=i.name,g=i.surname,h=i.country,b=i.city,v=i.age,E=i.bio,y=i.tags,w=i.isOnline,C=i.lastOnline,S=aa(),N=S.selectChat,T=S.createChat,A=Object(l.b)(),L=Object(l.c)((function(e){return e.chat.chat})),I=Object(l.c)((function(e){return e.general})),U=I.likes,D=I.matches,V=Object(n.useState)(!1),M=Object(s.a)(V,2),B=M[0],F=M[1],P=w?"(online)":"(last seen ".concat($n()(1e3*C).fromNow(),")"),R=D.includes(o),W=Object(n.useState)(!1),z=Object(s.a)(W,2),G=z[0],H=z[1];Object(n.useEffect)((function(){F((function(){return U.includes(o)}))}),[U,o]),Object(n.useEffect)((function(){L&&a.push("/chat/".concat(L))}),[L,a]);var $=function(){var e=Object(O.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N(o)){e.next=5;break}return e.next=3,T(o);case 3:if(!e.sent){e.next=5;break}N(o);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){H((function(e){return!e}))};return r.a.createElement(j.a,{container:!0,direction:"column",alignItems:"center",className:t.FullWidth},r.a.createElement(nr,{img:(null===d||void 0===d?void 0:d.image)||(null===(e=m[0])||void 0===e?void 0:e.image)||Vn.a}),r.a.createElement("div",null,r.a.createElement("div",{className:w?Bn()(t.Status,t.Online):t.Status})),r.a.createElement(j.a,{container:!0,direction:"column",alignItems:"center",item:!0,xs:12,sm:8,md:6},r.a.createElement(j.a,{container:!0,justify:"center",alignItems:"baseline"},r.a.createElement(Pa.a,{className:t.Name},"".concat(p," ").concat(g)),"male"===f?r.a.createElement(sr,null):r.a.createElement(ur,null),r.a.createElement(Pa.a,{className:t.Typography},P)),r.a.createElement(Pa.a,{color:"secondary",className:t.Location},"".concat(h,", ").concat(b)),r.a.createElement(Pa.a,{className:t.Typography},"".concat(v," years old")),r.a.createElement(Yn.a,{className:t.FullWidth}),r.a.createElement(tr,{tags:y}),r.a.createElement(Yn.a,{className:t.FullWidth}),r.a.createElement(cr,{bio:E||"UFO flew around and dropped this message here"}),r.a.createElement(Xn,{images:m}),r.a.createElement(k.a,{className:t.Report,onClick:K},"Report user"),R&&r.a.createElement(Aa.a,{variant:"extended",color:"primary",className:t.Message,onClick:$},r.a.createElement(ir.a,{className:t.FabIcon}),"Send message"),r.a.createElement(Aa.a,{variant:"extended",color:"secondary",className:t.Like,onClick:function(e){e.stopPropagation(),A(B?xe(o):ye(o))}},B?r.a.createElement(r.a.Fragment,null,r.a.createElement(Ln.a,{className:t.FabIcon}),"Unlike user"):r.a.createElement(r.a.Fragment,null,r.a.createElement(or.a,{className:t.FabIcon}),"Like user"))),r.a.createElement(hr,{open:G,onClose:K}))},Er=a(163),yr=a(341),xr=a(342),Or=Object(d.a)({Inputs:{width:"100%",margin:"10px 0"}}),jr=function(){var e=Or(),t=Object(l.c)((function(e){return e.filter})),a=t.username,n=t.city,c=t.country,i=t.gender,o=t.tags,s=t.age,u=t.rating,m=Object(l.b)(),d=ta().notif,f=[{name:"username",type:"text",label:"Username",value:a,onChange:function(e){m(Se({username:e.target.value}))}},{name:"ageRange",type:"slider",label:"Age range",value:[s.minAge,s.maxAge],onChange:function(e){return m(Se({age:e}))}},{name:"country",type:"text",label:"Country",value:c,onChange:function(e){m(Se({country:e.target.value}))}},{name:"city",type:"text",label:"City",value:n,onChange:function(e){m(Se({city:e.target.value}))}},{name:"gender",type:"radio",label:"I look for",values:["male","female","both"],value:i,onChange:function(e){m(Se({gender:e.target.value}))}},{name:"rating",type:"slider",label:"Rating range",value:[u.min,u.max],min:0,max:1,step:.05,onChange:function(e){return m(Se({rating:e}))}},{name:"tags",type:"autocomplete",values:o,onChange:function(e){m(Se({tags:e}))}}];return r.a.createElement(r.a.Fragment,null,f.map((function(t){var a=t.name,n=t.type,c=t.label,i=t.value,o=t.values,l=t.onChange,s=Object(Sa.a)(t,["name","type","label","value","values","onChange"]);return r.a.createElement(j.a,{className:e.Inputs,key:a,item:!0,xs:12},r.a.createElement(Ka,Object.assign({name:a,type:n,label:c,value:i,values:o,onChange:l},s)))})),r.a.createElement(k.a,{style:{margin:"10px 0"},onClick:function(){m(Ft(d,{username:a,city:n,country:c,gender:i,tags:o,age:s}))}},"get new strangers"))},wr=a(371),kr=Object(d.a)({Wrapper:{width:"100%",margin:"10px 0"},Active:{color:v.light,fontWeight:"bold"}}),Cr=function(){var e=kr(),t=Object(l.b)(),a=Object(n.useState)(!0),c=Object(s.a)(a,2),i=c[0],o=c[1],u=Object(n.useState)(null),m=Object(s.a)(u,2),d=m[0],f=m[1],p=function(e,t){return e.username.localeCompare(t.username)},g=function(e,t){return t.username.localeCompare(e.username)},h=function(e,t){return e.age-t.age},b=function(e,t){return t.age-e.age},v=function(e,t){return e.rating-t.rating},E=function(e,t){return t.rating-e.rating},y=function(e,t){return e.country.localeCompare(t.country)||e.city.localeCompare(t.city)},x=function(e,t){return t.country.localeCompare(e.country)||t.city.localeCompare(e.city)},O=Object(n.useCallback)((function(){switch(d){case"username":return i?p:g;case"age":return i?h:b;case"rating":return i?v:E;case"location":return i?y:x;default:return}}),[i,d]);return Object(n.useEffect)((function(){t(Yt({compareFunction:O()}))}),[i,d,O,t]),r.a.createElement(j.a,{container:!0,justify:"space-around",alignItems:"center",className:e.Wrapper},r.a.createElement(yr.a,{variant:"outlined"},r.a.createElement(k.a,{className:"username"===d&&e.Active,onClick:function(){return f("username")}},"username"),r.a.createElement(k.a,{className:"age"===d&&e.Active,onClick:function(){return f("age")}},"age"),r.a.createElement(k.a,{className:"rating"===d&&e.Active,onClick:function(){return f("rating")}},"rating"),r.a.createElement(k.a,{className:"location"===d&&e.Active,onClick:function(){return f("location")}},"location")),r.a.createElement(Ma.a,{control:r.a.createElement(wr.a,{checked:i,onChange:function(){return o((function(e){return!e}))},name:"isAscending"}),label:"Ascending order"}))},Sr=Object(d.a)({Wrapper:{position:"fixed",left:0,bottom:"39px",zIndex:6},Paper:{padding:"10px 40px",width:"70vw",minWidth:400,maxWidth:700,maxHeight:"80vh",overflow:"auto"},ButtonLabel:{fontFamily:"Righteous",fontSize:"1.2rem",padding:"0 15px"},Active:{boxShadow:"0 0 5px ".concat(v.light)},Arrow:{transition:"0.3s"},Less:{transform:"rotateX(180deg)"}}),Nr=function(){var e=Object(n.useState)(""),t=Object(s.a)(e,2),a=t[0],c=t[1],i=Object(n.useState)(!1),o=Object(s.a)(i,2),l=o[0],u=o[1],m=Sr(a),d=function(){u((function(e){return!e}))},f=function(e){var t=!a||(e===a||!l);c(e),t&&d()};return r.a.createElement(j.a,{className:m.Wrapper,container:!0,item:!0,xs:12,justify:"center",self:"flex-end"},r.a.createElement(Er.a,{className:m.Paper},r.a.createElement(j.a,{container:!0,direction:"column",alignItems:"center"},r.a.createElement(j.a,{container:!0,item:!0,direction:"column",alignItems:"center"},l&&("filter"===a?r.a.createElement(jr,null):r.a.createElement(Cr,null))),r.a.createElement(j.a,{container:!0,justify:"space-evenly",alignItems:"center",item:!0},r.a.createElement(yr.a,{variant:"text",color:"secondary","aria-label":"text primary button group"},r.a.createElement(k.a,{className:l&&"filter"===a&&m.Active,classes:{label:m.ButtonLabel},onClick:function(){return f("filter")}},"Filter"),r.a.createElement(k.a,{className:l&&"sort"===a&&m.Active,classes:{label:m.ButtonLabel},onClick:function(){return f("sort")}},"Sort")),r.a.createElement(k.a,{onClick:d,size:"small",color:"secondary"},r.a.createElement(xr.a,{className:l?m.Arrow:Bn()(m.Arrow,m.Less)}))))))},Tr=Object(d.a)({Strangers:{fontSize:"2rem",paddingBottom:"60px"},CardContainer:{paddingBottom:"90px"},Text:{marginTop:"1rem",width:"100%",textAlign:"center"}}),Ar=function(){var e=ta().notif,t=Object(l.c)((function(e){return e.users.users})),a=Object(l.c)((function(e){return e.users.strangers})),c=Object(l.c)((function(e){return e.filter})),i=Object(u.h)(),o=Object(n.useState)(null),m=Object(s.a)(o,2),d=m[0],f=m[1],p=Object(n.useState)(null),g=Object(s.a)(p,2),h=g[0],b=g[1],v=Tr(),E=Object(l.b)();Object(n.useEffect)((function(){E(Ft(e))}),[]),Object(n.useLayoutEffect)((function(){for(var e=a.filter((function(e){return e.age>=c.age.minAge&&e.age<=c.age.maxAge&&e.rating>=c.rating.min&&e.rating<=c.rating.max})),t=function(){var t=o[n];e=c[t].length>0?e.filter((function(e){return e[t].toLowerCase().includes(c[t].toLowerCase())})):e},n=0,o=["username","city","country"];n<o.length;n++)t();if(e=c.gender.length>0&&"both"!==c.gender?e.filter((function(e){return e.gender===c.gender})):e,e=c.tags.length>0?e.filter((function(e){var t=new RegExp(c.tags.reduce((function(e,t){return"".concat(t,"|").concat(e)})).replace(/\\/g,"\\\\").replace("(","\\(").replace(")","\\)"));return!e.tags||0===e.tags.length||e.tags.find((function(e){return t.test(e)}))})):e,!(i.pathname.length>1)){var l=e&&e.length?e.map((function(e){return r.a.createElement(Gn,{user:e,key:e.id})})):r.a.createElement(Pa.a,{className:v.Text},"No users to display");f(l)}}),[c,v.Text,a,i.pathname]);var y=Object(n.useMemo)((function(){return t&&t.map((function(e){return r.a.createElement(u.b,{key:e.id,path:"/strangers/:id",render:function(){return r.a.createElement(vr,{user:e})}})}))}),[t]);return Object(n.useEffect)((function(){b(y)}),[y]),r.a.createElement(j.a,{container:!0,direction:"column",alignItems:"center",className:v.Strangers},r.a.createElement(u.d,null,h,r.a.createElement(u.b,{path:"/",exact:!0,render:function(){return r.a.createElement(j.a,{className:v.CardContainer,container:!0,item:!0,xs:10,spacing:3},d,r.a.createElement(Nr,null))}})))},Lr=Object(d.a)({root:{width:"70%",textAlign:"center"},"@media (max-width: 960px)":{root:{width:"100%"}}});var Ir=function(e){var t=Lr(),a=e.children,n=e.value,c=e.index,i=Object(Sa.a)(e,["children","value","index"]);return r.a.createElement(Fa.a,Object.assign({className:t.root,role:"tabpanel",hidden:n!==c,id:"full-width-tabpanel-".concat(c),"aria-labelledby":"full-width-tab-".concat(c),borderRadius:0},i),a)},Ur=a(157),Dr=a.n(Ur),Vr=a(343),Mr=a(377),Br=Object(d.a)({Avatar:{width:"300px",height:"300px"}}),Fr=function(){var e=Br(),t=Object(l.b)(),a=Object(l.c)((function(e){return e.general})),c=a.id,i=a.images,o=a.avatar,u=ta().notif,m=Object(n.useState)(null),d=Object(s.a)(m,2),f=d[0],p=d[1],g=function(){var e=Object(O.a)(x.a.mark((function e(a){var n,r,o,l;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.target.files&&0!==a.target.files.length){e.next=2;break}return e.abrupt("return");case 2:return(n=a.target.files[0]).size>1e6&&u("The file is larger than 1MB","error"),e.prev=4,e.next=7,W(c,n);case 7:if(r=e.sent,o=URL.createObjectURL(n),l={id:r.data.data.id,image:o},!r.data.status||!r.data.data){e.next=16;break}p(l),t(ba({images:[].concat(Object(D.a)(i),[l])})),u("The file was uploaded","success"),e.next=18;break;case 16:throw URL.revokeObjectURL(o),new Error("Unable to upload a photo");case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(4),u(e.t0,"error");case 23:case"end":return e.stop()}}),e,null,[[4,20]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(Vr.a,{overlap:"circle",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:r.a.createElement(Aa.a,{color:"primary","aria-label":"upload image",component:"label",onChange:function(e){return g(e)}},r.a.createElement(Dr.a,null),r.a.createElement("input",{type:"file",style:{display:"none"}}))},r.a.createElement(Mr.a,{className:e.Avatar,src:(null===f||void 0===f?void 0:f.image)||(null===o||void 0===o?void 0:o.image)||Vn.a}))},Pr=a(344),Rr=a(315),Wr=Object(d.a)((function(e){return{root:{width:"100%",flexWrap:"nowrap"},Avatar:{marginRight:"1rem"},Text:{fontSize:"1rem",marginLeft:"auto",flexGrow:1},Date:{fontSize:"0.8rem",color:e.palette.grey[500]}}})),_r=function(e){var t,a,n,c,i=e.notification,o=Wr();return r.a.createElement(j.a,{container:!0,alignItems:"center",className:o.root},r.a.createElement(Mr.a,{className:o.Avatar,src:(null===(t=i.user)||void 0===t||null===(a=t.avatar)||void 0===a?void 0:a.image)||(null===(n=i.user)||void 0===n||null===(c=n.images[0])||void 0===c?void 0:c.image)||Vn.a}),r.a.createElement(Pa.a,{className:o.Text},function(e){switch(e){case ft.NEW_LIKE:return"".concat(i.user.name," like you");case ft.DELETE_LIKE:return"".concat(i.user.name," does not like you anymore");case ft.NEW_LOOK:return"".concat(i.user.name," has visited you");case ft.NEW_MATCH:return"Match with ".concat(i.user.name,"!");case ft.DELETE_MATCH:return"You have no match with ".concat(i.user.name," anymore");default:throw new Error("[NotificationListItem] No such type in notification")}}(i.type)),r.a.createElement(Pa.a,{className:o.Date},function(e){var t=new Date(e),a=new Date,n=new Date(a.getFullYear(),a.getMonth(),a.getDate()).valueOf();return e<n-864e5?"".concat(t.getDay()," ").concat(t.getMonth()):e<n?"yesterday":t.toTimeString().split(" ")[0]}(i.date)))},zr=Object(d.a)((function(e){return{Avatar:{marginRight:"1rem"},Text:{fontSize:"1.5rem"},SecondaryText:{fontSize:"1.2rem",color:e.palette.grey[500]}}})),Gr=function(e){var t,a,n=e.user,c=zr();return r.a.createElement(j.a,{container:!0,alignItems:"center",wrap:"nowrap"},r.a.createElement(Mr.a,{className:c.Avatar,src:(null===n||void 0===n||null===(t=n.avatar)||void 0===t?void 0:t.image)||(null===n||void 0===n?void 0:n.images)?null===(a=n.images[0])||void 0===a?void 0:a.image:Vn.a}),r.a.createElement(j.a,{container:!0,direction:"column"},r.a.createElement(Pa.a,{className:c.Text},"".concat(n.name," ").concat(n.surname)),r.a.createElement(Pa.a,{className:c.SecondaryText},"".concat(n.age," years. ").concat(n.city,", ").concat(n.country))))},Hr=Object(d.a)((function(e){return{Button:{padding:"7px 30px"},Menu:{width:"100%"},ListItem:{borderRadius:"30px"},Unread:{backgroundColor:e.palette.grey[200]},Center:{textAlign:"center"}}})),$r=Object(n.forwardRef)((function(e,t){var a=e.items,n=e.autoFocusItem,c=e.defaultText,i=e.setOpen,o=e.action,s=Hr(),m=Object(l.b)(),d=Object(u.g)(),f=Object(u.h)();var p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(a.length){t&&m(At({id:t}));var n=f.pathname.split("/")[1];m(ve({parent:n})),m(he({companion:e})),d.push("/strangers/".concat(e.id)),i&&i(!1)}};return r.a.createElement(Rr.a,{className:s.Menu,ref:t,autoFocusItem:n,id:"users-list",onKeyDown:function(e){i&&"Tab"===e.key&&(e.preventDefault(),i&&i(!1))}},a&&a.length>0?a.map((function(e){return e?e.user?r.a.createElement(Ia.a,{className:e.status===pt.READ?s.ListItem:Bn()(s.ListItem,s.Unread),onClick:function(){return p(e.user,e.id)},key:e.id},r.a.createElement(_r,{notification:e})):r.a.createElement(Ia.a,{className:s.ListItem,onClick:function(){return p(e)},key:e.id},r.a.createElement(Gr,{user:e}),o&&r.a.createElement(k.a,{className:s.Button,color:o.color,endIcon:o.icon,onClick:function(t){return function(e,t){e.stopPropagation(),o.onClick(t)}(t,e.id)}},"unban user")):null})):r.a.createElement(Pa.a,{className:s.Center},c))})),Kr=function(){var e=Rn(),t=e.banned,a=e.unbanAndUpdate,c=Object(l.b)(),i=Object(l.c)((function(e){return e.users.users}));Object(n.useLayoutEffect)((function(){c(Pt(t))}),[c,t]);var o=Object(n.useMemo)((function(){return i&&i.length?t.map((function(e){return i.find((function(t){return t.id===e}))})):[]}),[t,i]),s=Object(n.useMemo)((function(){return{icon:r.a.createElement(Pr.a,null),color:"secondary",onClick:a}}),[a]);return r.a.createElement(j.a,{container:!0,justify:"center"},t?r.a.createElement($r,{items:o,defaultText:"No users banned. Yet...",action:s}):r.a.createElement(Pa.a,null,"No users banned. Yet..."))},qr=a(158),Yr=a.n(qr),Jr=function(e){var t=Za(),a=Object(l.c)((function(e){return e.register})),c=a.password,i=a.passwordValid,o=a.confirm,s=a.confirmValid,m=Object(l.b)(),d=Object(u.h)(),f=ta().notif,p=i&&s,g=Yr.a.parse(d.search),h=function(){var e=Object(O.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F("/reset",{params:{k:t}});case 3:(a=e.sent).data.status||f("".concat(a.data.data,". Try request link once again"),"warning"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),f("Server error","error");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(O.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,F.put("/reset",{password:c});case 4:(a=e.sent).data.status?f("New password successfully saved","success"):f(a.data.data,"success"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),f("Server error","error");case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){h(g.k)}),[]);var v=[{name:"password",type:"password",label:"Password",value:c,required:!0,onValidate:function(e){m(sn(e))},onChange:function(e){m(rn(e.target.value))},rules:{helperText:"Use at least one lower- and uppercase letter, number and symbol. Min length 4",rule:{minLength:4,maxLength:20,regex:/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[-+_!@#$%^&*.,?]).{4,}$/}}},{name:"confirm",type:"password",label:"Confirm",value:o,required:!0,onValidate:function(e){m(un(e))},onChange:function(e){m(cn(e.target.value))},rules:{helperText:"Confirm and password does not match",rule:{minLength:3,maxLength:20,regex:new RegExp("^".concat(c,"$"))}}}],E=[{component:"button",type:"submit",text:"Save new password",size:"large",disabled:!p,onClick:b}];return r.a.createElement(j.a,{container:!0,direction:"column",alignItems:"center",justify:"center",className:t.SingleForm},r.a.createElement(Ya,{inputs:v,buttons:E}))},Zr=a(345),Xr=Object(n.forwardRef)((function(e,t){return r.a.createElement(Zr.a,Object.assign({direction:"up",ref:t},e))}));function Qr(e){var t=e.buttonText,a=e.yesText,c=e.noText,i=e.header,o=e.text,u=e.className,m=Object(n.useState)(!1),d=Object(s.a)(m,2),f=d[0],p=d[1],g=Object(l.b)(),h=ta().notif,b=function(){p(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,{variant:"outlined",color:"primary",onClick:function(){p(!0)},className:u},t),r.a.createElement(mr.a,{open:f,TransitionComponent:Xr,keepMounted:!0,onClose:b,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description"},r.a.createElement(dr.a,{id:"alert-dialog-slide-title"},i),r.a.createElement(fr.a,null,r.a.createElement(pr.a,{id:"alert-dialog-slide-description"},o)),r.a.createElement(gr.a,null,r.a.createElement(k.a,{onClick:b,color:"primary"},c),r.a.createElement(k.a,{onClick:function(){var e;g((e=h,function(){var t=Object(O.a)(x.a.mark((function t(a){var n;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,F.delete("account");case 3:if(n=t.sent,console.log(n.data),!n.data.status){t.next=12;break}e("Account successfully deleted","success"),a(ha()),a(ge()),a(Ne()),t.next=13;break;case 12:throw new Error(n.data.data);case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(0),a(fa()),e(t.t0,"error");case 19:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}())),p(!1)},color:"secondary"},a))))}var ec=Object(d.a)({FullWidth:{width:"100%"},Button:{width:"80%",margin:"0.5rem 0"},lastButton:{marginTop:"2rem"},"@media (max-width: 600px)":{Button:{width:"100%"}}}),tc=function(){var e=ec(),t=Object(l.b)(),a=Object(u.g)(),c=ta().notif,i=Object(l.c)((function(e){return e.additional})),o=i.email,m=i.phone,d=i.birthDate,f=i.maxDist,p=i.lookFor,g=i.minAge,h=i.maxAge,b=i.emailValid,v=i.phoneValid,E=Object(l.c)((function(e){return e.general})),y=Object(n.useState)(!0),w=Object(s.a)(y,2),C=w[0],S=w[1],N=function(){var e=Object(O.a)(x.a.mark((function e(a){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.preventDefault(),t(it({email:o,phone:m,birthDate:d,maxDist:f,lookFor:p,minAge:g,maxAge:h},c));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){S(b&&v)}),[b,v]);var T=[{name:"email",type:"email",label:"Email",value:o,ignoreUntouched:!0,onChange:function(e){t(Ve(e.target.value))},onValidate:function(e){t(Je(e))},rules:{helperText:"invalid email",rule:{minLength:3,maxLength:40,regex:/^([\w%+-.]+)@([\w-]+\.)+([\w]{2,})$/i}}},{name:"phone",type:"text",label:"Phone",value:m,ignoreUntouched:!0,onChange:function(e){t(_e(e.target.value))},onValidate:function(e){t(tt(e))},rules:{helperText:"invalid phone",rule:{minLength:0,maxLength:12,regex:/^$|^\+?\d+$/}}},{name:"birthDate",type:"date",label:"Birth date",value:d,onChange:function(e){t(Re(e.target.value))}},{name:"lookFor",type:"radio",label:"I look for",values:["male","female","both"],value:p,onChange:function(e){t($e(e.target.value))}},{name:"maxDist",type:"slider",label:"Search distance, km",step:10,min:10,max:1e4,value:f,onChange:function(e){t(He(e))}},{name:"ageRange",type:"slider",label:"Age search range",value:[g,h],onChange:function(e){t(Ke(e))}}],A=[{component:"fab",type:"submit",text:"Save",size:"large",disabled:!C,onClick:N}],L=[{text:"request change password link",size:"large",onClick:function(){t(ve({parent:"profile"})),t(pe({header:"Update password"})),t(me()),F.post("/reset",{email:o}),c("Check your email","info")}},{text:"back",size:"large",onClick:function(){t(De(E)),t(Ee(a,"profile"))},className:e.lastButton}],I={text:"This action is irreversable. All your images, chats and likes will be vanished.",header:"Are you sure?",yesText:"Agree",noText:"Disagree",buttonText:"Delete account",className:e.Button};return r.a.createElement(j.a,{container:!0,direction:"column",alignItems:"center",className:e.FullWidth},r.a.createElement(Ya,{inputs:T,buttons:A}),r.a.createElement(Qr,I),L.map((function(t){t.component;var a=t.variant,n=t.text,c=t.onClick,i=t.className,o=Object(Sa.a)(t,["component","variant","text","onClick","className"]);return r.a.createElement(k.a,Object.assign({key:n,className:i?Bn()(i,e.Button):e.Button,variant:a,onClick:c},o),n)})))},ac=function(){var e=Object(l.c)((function(e){return e.general})),t=Object(l.c)((function(e){return e.additional})),a=t.username,c=t.name,i=t.surname,o=t.bio,m=t.gender,d=t.country,f=t.city,p=t.usernameValid,g=t.nameValid,h=t.surnameValid,b=t.countryValid,v=t.cityValid,E=t.tags,y=Object(l.b)(),j=Object(u.g)(),w=ta().notif,k=Object(n.useState)(!0),C=Object(s.a)(k,2),S=C[0],N=C[1];Object(n.useEffect)((function(){N(p&&g&&h&&b&&v)}),[p,g,h,b,v]);var T=[{name:"username",type:"text",label:"Username",value:a,ignoreUntouched:!0,onChange:function(e){y(Me(e.target.value))},onValidate:function(e){y(Ze(e))},rules:{helperText:"Use letters, numbers or symbols ., %, _, -, +. Min length 3",rule:{minLength:3,maxLength:20,regex:/^[\w%-+.]+$/}}},{name:"name",type:"text",label:"First name",value:c,ignoreUntouched:!0,onChange:function(e){y(Be(e.target.value))},onValidate:function(e){y(Xe(e))},rules:{helperText:"Use letters, numbers or symbols ., -. Min length 2",rule:{minLength:2,maxLength:20,regex:/^[\w-.]+$/}}},{name:"surname",type:"text",label:"Last name",value:i,ignoreUntouched:!0,onChange:function(e){y(Fe(e.target.value))},onValidate:function(e){y(Qe(e))},rules:{helperText:"Use letters, numbers or symbols ., -. Min length 2",rule:{minLength:2,maxLength:20,regex:/^[\w-.]+$/}}},{name:"gender",type:"radio",label:"I am",values:["male","female"],value:m,onChange:function(e){y(We(e.target.value))}},{name:"country",type:"text",label:"Country",value:d,ignoreUntouched:!0,onChange:function(e){y(ze(e.target.value))},onValidate:function(e){y(at(e))},rules:{helperText:"Use letters, numbers or symbols ., -. Min length 2",rule:{minLength:2,maxLength:20,regex:/^[\w-.]+$/}}},{name:"city",type:"text",label:"City",value:f,ignoreUntouched:!0,onChange:function(e){y(Ge(e.target.value))},onValidate:function(e){y(nt(e))},rules:{helperText:"Use letters, numbers or symbols ., -. Min length 2",rule:{minLength:2,maxLength:20,regex:/^[\w-.]+$/}}},{name:"bio",type:"text",label:"Bio",value:o,ignoreUntouched:!0,onChange:function(e){y(Pe(e.target.value))},onValidate:function(e){et(e)},rules:{helperText:"Write some info about yourself",rule:{minLength:2,maxLength:256,regex:/^.+$/}}},{name:"tags",type:"autocomplete",values:E||[],onChange:function(e){return y(qe(e))}}],A=[{component:"fab",type:"submit",text:"Save",size:"large",disabled:!S,onClick:function(){var e=Object(O.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),y(it({username:a,name:c,surname:i,gender:m,country:d,city:f,bio:o,tags:E},w));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{text:"back",size:"large",onClick:function(){y(De(e)),y(Ee(j,"profile"))},style:{marginBottom:"2rem"}}];return r.a.createElement(Ya,{inputs:T,buttons:A})},nc=a(265),rc=Object(d.a)((function(e){return{formControl:{margin:e.spacing(3)},Buttons:{marginTop:30}}})),cc=function(){var e=rc(),t=Object(u.g)(),a=Object(l.b)(),c=Object(l.c)((function(e){return e.general})).useLocation,i=Object(n.useState)({location:c,email:!0}),o=Object(s.a)(i,2),m=o[0],d=o[1],f=ta().notif,p=m.location,g=m.email,h=function(e){d(Object(_.a)(Object(_.a)({},m),{},Object(Ja.a)({},e.target.name,e.target.checked)))};return r.a.createElement(j.a,null,r.a.createElement(Ua.a,{component:"fieldset",className:e.formControl},r.a.createElement(Da.a,{component:"legend"},"Profile settings"),r.a.createElement(nc.a,null,r.a.createElement(Ma.a,{control:r.a.createElement(wr.a,{checked:p,onChange:h,color:"primary",name:"location"}),label:"Use my current location for search"}),r.a.createElement(Ma.a,{control:r.a.createElement(wr.a,{checked:g,onChange:h,color:"primary",name:"email"}),label:"Send email notification"})),r.a.createElement(j.a,{className:e.Buttons,container:!0,justify:"space-around"},r.a.createElement(k.a,{onClick:function(){a(Ee(t,"profile"))}},"cancel"),r.a.createElement(k.a,{onClick:function(){console.log("[ProfileSettings]",m),a(ba({useLocation:m.location})),a(Ye(m.location)),a(it({useLocation:m.location},f))},variant:"contained"},"Save"))))},ic=Object(d.a)({root:{width:"100%"},Button:{width:"60%",margin:"0.5rem 0"},"@media (max-width: 600px)":{Button:{width:"100%"}}}),oc=function(){var e=ic(),t=Object(u.g)(),a=Object(l.b)(),n=function(e){var n=e.header,r=e.url;a(ve({parent:"profile"})),a(pe({header:n})),a(me()),t.push("/profile/".concat(r))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/profile",exact:!0},r.a.createElement(j.a,{container:!0,direction:"column",alignItems:"center",className:e.root},r.a.createElement(k.a,{className:e.Button,onClick:function(){n({header:"Update public info",url:"public"})}},"Update public info"),r.a.createElement(k.a,{className:e.Button,onClick:function(){n({header:"Update personal info",url:"personal"})}},"Update personal info"),r.a.createElement(k.a,{className:e.Button,onClick:function(){n({header:"Settings",url:"settings"})}},"Settings"))),r.a.createElement(u.b,{path:"/profile/public",component:ac}),r.a.createElement(u.b,{path:"/profile/personal",component:tc}),r.a.createElement(u.b,{path:"/profile/settings",component:cc}),r.a.createElement(u.b,{path:"/profile/password-update",component:Jr})))},lc=Object(d.a)({indicator:{backgroundColor:"#ffffff00",border:"1px solid ".concat(b.dark),bottom:0,height:"100%",borderRadius:"30px","&:hover,&:focus":{borderColor:v.main}},TabPanel:{backgroundColor:h,borderRadius:"30px",padding:"5px"},Profile:{minHeight:"100vh",padding:"30px",paddingBlockEnd:"60px"},Tab:{"&:hover,&:focus":{color:v.main}}}),sc=[{id:0,text:"Gallery",component:r.a.createElement(Xn,null)},{id:1,text:"Banned",component:r.a.createElement(Kr,null)},{id:2,text:"Settings",component:r.a.createElement(oc,null)}],uc=Object(n.createContext)(sc[0].id),mc=function(){var e=lc(),t=Object(n.useState)(0),a=Object(s.a)(t,2),c=a[0],i=a[1],o=sc.map((function(t,a){return r.a.createElement(gn.a,{className:e.Tab,disableRipple:!0,label:t.text,key:a})}));return r.a.createElement(j.a,{container:!0,wrap:"nowrap",direction:"column",justify:"flex-start",alignItems:"center",className:e.Profile},r.a.createElement(uc.Provider,{value:c},r.a.createElement(Fr,null),r.a.createElement(vn.a,{classes:{root:e.TabPanel,indicator:e.indicator},value:c,onChange:function(e,t){i(t)}},o),r.a.createElement(Ir,{value:c,index:sc[c].id,key:sc[c].id},sc[c].component)))},dc=a(259),fc=a(333),pc=a(349),gc=a(159),hc=a.n(gc),bc=a(347);function vc(e){var t=e.children,a=Object(bc.a)({disableHysteresis:!0,threshold:0});return Object(n.cloneElement)(t,{elevation:a?4:0})}var Ec=Object(d.a)({Appbar:{paddingTop:"10px",backgroundColor:g},Header:{textAlign:"center",fontFamily:"Righteous",color:b.dark,fontSize:"2rem",textTransform:"capitalize"},Popper:{zIndex:5,textAlign:"center"},PopperPaper:{padding:"1rem 1.5rem"},Notifications:{overflowY:"scroll",maxHeight:500,scrollbarWidth:"none","&hover":{scrollbarWidth:"auto"},"&:hover>&::-webkit-scrollbar":{opacity:1},"&::-webkit-scrollbar":{width:3,opacity:0},"&::-webkit-scrollbar-thumb":{borderRadius:3}},Category:{fontSize:"1rem",fontWeight:700},Button:{marginLeft:20}}),yc=function(e){var t=e.header,a=Ec(),c=Object(l.c)((function(e){return e.users.users})),i=Object(l.c)((function(e){return e.general})),o=Object(l.c)((function(e){return e.WS})).notifications,m=Object(n.useState)(null),d=Object(s.a)(m,2),f=d[0],p=d[1],g=Object(u.h)(),h=Object(u.g)(),v=Object(l.b)(),E=Object(n.useState)(!1),y=Object(s.a)(E,2),x=y[0],O=y[1],w=Object(n.useRef)(null);Object(n.useEffect)((function(){var e=o.map((function(e){return e.userId}));v(Pt(e))}),[v,o]),Object(n.useEffect)((function(){if(o&&o.length){var e=o.map((function(e){var t=c.find((function(t){return t.id===e.userId}));return Object(_.a)(Object(_.a)({},e),{},{user:t})})).reverse();e&&p(e)}}),[c,o]);var C=function(){v(Lt())},S=g.pathname.split("/").length>2,N=function(e){w.current&&w.current.contains(e.target)||O(!1)},T=f&&f.length?f.reduce((function(e,t){return e+(t.status===pt.NEW?1:0)}),0):0;return r.a.createElement(vc,null,r.a.createElement(bn.a,{className:a.Appbar},r.a.createElement(j.a,{container:!0,justify:"space-around",alignItems:"center",item:!0},r.a.createElement(j.a,{item:!0,xs:2},S?r.a.createElement(k.a,{variant:"text",color:"inherit",onClick:function(){var e=g.pathname.split("/")[1];"profile"===e&&v(De(i)),v(Ee(h,e))}},r.a.createElement(An.a,{style:{color:b.dark},fontSize:"large"})):null),r.a.createElement(j.a,{item:!0,xs:6},r.a.createElement(Pa.a,{variant:"h1",className:a.Header},t)),r.a.createElement(j.a,{item:!0,xs:2},r.a.createElement(k.a,{ref:w,variant:"text",color:"inherit",onClick:function(){O((function(e){return!e}))}},r.a.createElement(Vr.a,{color:"secondary",overlap:"circle",variant:"dot",badgeContent:T},r.a.createElement(hc.a,{style:{color:b.dark},fontSize:"large"}))),r.a.createElement(dc.a,{className:a.Popper,open:x,anchorEl:w.current,placement:"left",transition:!0,disablePortal:!0},(function(e){var t=e.TransitionProps;return r.a.createElement(fc.a,t,r.a.createElement(Er.a,{className:a.PopperPaper},r.a.createElement(Pa.a,{className:a.Category},"Notifications"),f?r.a.createElement(j.a,{container:!0,justify:"center",alignItems:"center",className:a.Notifications},r.a.createElement(pc.a,{onClickAway:N},r.a.createElement($r,{items:f,autoFocusItem:x,setOpen:O})),r.a.createElement(k.a,{size:"small",onClick:C,className:a.Button},"Read all")):r.a.createElement(Pa.a,null,"No recent actions yet")))}))))))},xc=a(350),Oc=a(351),jc=Object(d.a)((function(e){return{List:{width:"100%",textAlign:"center"},ListItem:{width:"80%",margin:"0 auto",display:"flex",justifyContent:"space-around",alignItems:"center",borderRadius:"30px"},Username:{fontWeight:800},Text:{fontSize:"1rem"},Secondary:{display:"-webkit-box",lineClamp:1,boxOrient:"vertical",overflow:"hidden"},Status:{border:"3px solid theme.palette.grey[500]"},Online:{backgroundColor:e.palette.success.main},Badge:{backgroundColor:"#44b700",color:"#44b700",boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}},NewMessages:{padding:"5px 8px",borderRadius:20,backgroundColor:e.palette.primary.light}}})),wc=function(){var e=jc(),t=Object(l.c)((function(e){return e.chat.chats})),a=Object(l.c)((function(e){return e.users.users})),c=Object(l.c)((function(e){return e.general.id})),i=Object(u.g)(),o=Object(l.b)(),s=aa().getChatsInfo;Object(n.useEffect)((function(){s()}),[]);var m=t.map((function(e){var t=Object(_.a)({},e),n=t.userIds.find((function(e){return e!==c})),r=a.find((function(e){return e.id===n}));return t.user=Object(_.a)({},r),t}));return r.a.createElement(Na.a,{className:e.List},m.length?m.map((function(t){var a,n,c=Object(_.a)({},t.user),l=c.name,s=c.avatar,u=c.images,m=c.isOnline,d=Object(_.a)({},t).messages,f=d.filter((function(e){return e.status!==ht.STATUS_READ}));console.log(t);var p=(null===s||void 0===s?void 0:s.image)||(null===(a=u[0])||void 0===a?void 0:a.image)||null;return r.a.createElement(Ta.a,{className:e.ListItem,button:!0,onClick:function(){return e=t.id,a=t.user,o(Q({id:e})),o(he({companion:a})),void i.push("/chat/".concat(e));var e,a},key:t.id},r.a.createElement(Vr.a,{color:"primary",overlap:"circle",variant:"dot",badgeContent:m?1:0,classes:{badge:e.Badge}},r.a.createElement(xc.a,null,r.a.createElement(Mr.a,{src:p,alt:l}))),r.a.createElement(Oc.a,{primary:l,primaryTypographyProps:{className:e.Username},secondary:d&&(null===(n=d[d.length-1])||void 0===n?void 0:n.text)||"",secondaryTypographyProps:{className:e.Secondary}}),f.length>0&&r.a.createElement("div",{className:e.NewMessages},f.length))})):r.a.createElement(Pa.a,{className:e.Text},"No chats yet"))},kc=a(352),Cc=a(353),Sc=Object(d.a)({Container:{width:"100%",justifyContent:function(e){return e.self?"flex-end":"flex-start"},"& $Paper":{borderRadius:function(e){return e.self?"30px 30px 5px 30px":"5px 30px 30px 30px"}}},Paper:{padding:"0.4rem 1.5rem",marginLeft:"1rem",maxWidth:"60%",backgroundColor:function(e){return e.self?b.light:h}},Typography:{fontSize:"1rem"},Info:{justifyContent:function(e){return e.self?"flex-end":"flex-start"}},Date:{fontSize:"0.7rem",color:b.contrastTextLighter},Icon:{marginLeft:"0.3rem",fontSize:"0.7rem",color:function(e){return e.status===ht.STATUS_NEW?b.contrastTextLighter:v.main}},Badge:{backgroundColor:"#44b700",color:"#44b700",boxShadow:"0 0 0 2px ".concat(E.palette.background.paper),transform:"translate(0px, 0px)","&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",border:"1px solid currentColor",content:'""'}},"@media (max-width: 600px)":{Avatar:{display:"none"},Paper:{maxWidth:"100%",padding:"0.3rem 1rem"}}}),Nc=function(e){var t=Object(_.a)({},e),a=t.self,n=t.text,c=t.image,i=t.name,o=t.date,s=t.status,u=Object(l.c)((function(e){return e.UI.companion.isOnline})),m=Sc({self:a,status:s});return r.a.createElement(j.a,{container:!0,className:m.Container},a?null:r.a.createElement(Vr.a,{color:"primary",variant:"dot",badgeContent:u?1:0,classes:{badge:m.Badge}},r.a.createElement(Mr.a,{className:m.Avatar,src:c,alt:i})),r.a.createElement(Er.a,{elevation:1,className:m.Paper},r.a.createElement(j.a,{container:!0},r.a.createElement(Pa.a,{className:m.Typography},n)),r.a.createElement(j.a,{className:m.Info,container:!0,alignItems:"center"},r.a.createElement(Pa.a,{component:"span",className:m.Date},function(e){var t=new Date(e),a=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes();return"".concat(t.getHours(),":").concat(a)}(o)),s===ht.STATUS_READ?r.a.createElement(kc.a,{className:m.Icon}):r.a.createElement(Cc.a,{className:m.Icon}))))},Tc=a(374),Ac=a(160),Lc=a.n(Ac),Ic=Object(d.a)({Wrapper:{border:"1px solid #ccc",borderRadius:"45px",padding:"10px",backgroundColor:h},Input:{flexGrow:2,paddingLeft:"20px"},Send:{boxShadow:"none"},Icon:{transform:"rotate(-38deg) skew(17deg, 4deg) translateX(2px)"},Form:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"}}),Uc=function(){var e=Ic(),t=r.a.useState(""),a=Object(s.a)(t,2),n=a[0],c=a[1],i=Object(l.c)((function(e){return e.UI.companion.id})),o=aa().newMsg;return r.a.createElement(j.a,{container:!0,justify:"center",alignItems:"center"},r.a.createElement(j.a,{className:e.Wrapper,container:!0,direction:"row",justify:"center",alignItems:"center",item:!0,xs:10,sm:8},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),n.length&&(o(i,n),c(""))},className:e.Form},r.a.createElement(Tc.a,{className:e.Input,onChange:function(e){return c(e.target.value)},value:n}),r.a.createElement(Aa.a,{type:"submit",className:e.Send,size:"small",color:"secondary"},r.a.createElement(Lc.a,{className:e.Icon})))))},Dc=Object(d.a)({Container:{minHeight:"91vh"},List:{flexGrow:2,width:"70%",maxHeight:"70vh",margin:"0 auto",overflowY:"auto"},ListItem:{margin:"20px auto"},Header:{marginTop:"30px"},SendForm:{marginTop:"auto",marginBottom:"70px"}}),Vc=function(){var e=Object(l.c)((function(e){return e.UI.companion})),t=e.name,a=e.avatar,c=e.images,i=Object(l.c)((function(e){return e.chat})),o=i.chat,u=i.chats.find((function(e){return e.id===o})).messages,m=Object(l.c)((function(e){return e.general.id})),d=Dc(),f=aa().readMsg,p=Object(n.useState)([]),g=Object(s.a)(p,2),h=g[0],b=g[1],v=Object(n.useRef)(null);console.log("[ChatRoom] mappedMessages",h),console.log("[ChatRoom] messages",u);var E=Object(n.useMemo)((function(){return u&&u.length?u.map((function(e){var n;return r.a.createElement(Ta.a,{key:e.id,className:d.ListItem},r.a.createElement(Nc,{self:e.sender===m,text:e.text,image:(null===a||void 0===a?void 0:a.image)||(null===(n=c[0])||void 0===n?void 0:n.image),name:t,date:e.date,status:e.status}))})):[]}),[a,d.ListItem,c,u,m,t]);return Object(n.useEffect)((function(){b(E)}),[E]),Object(n.useEffect)((function(){u&&u.length&&(u.forEach((function(e){if(e.sender!==m)switch(e.status){case ht.STATUS_NEW:case ht.STATUS_DELIVERED:return void f(e);case ht.STATUS_READ:default:return}})),v.current.scrollIntoView({behavior:"smooth"}))}),[u,m,f]),r.a.createElement(j.a,{container:!0,direction:"column",justify:"flex-start",alignItems:"stretch",spacing:1,className:d.Container},r.a.createElement(Na.a,{className:d.List},h.length?h:"No messages yet",r.a.createElement("div",{ref:v})),r.a.createElement(j.a,{item:!0,className:d.SendForm},r.a.createElement(Uc,null)))},Mc=Object(d.a)({Grid:{overflow:"hidden",width:"100%"}}),Bc=function(){var e=Mc(),t=Object(l.c)((function(e){return e.chat.chats}));return r.a.createElement(j.a,{container:!0,justify:"center",direction:"column",className:e.Grid},r.a.createElement(u.d,null,t.map((function(e){return r.a.createElement(u.b,{key:e.id,path:"/chat/".concat(e.id),render:function(){return r.a.createElement(Vc,null)}})})),r.a.createElement(u.b,{path:"/chat",exact:!0,render:function(){return r.a.createElement(wc,null)}})))},Fc=Object(d.a)((function(e){return{root:{paddingBottom:40},Grid:{overflow:"hidden",width:"100%"},Header:{fontSize:"1.5rem",marginTop:30,fontFamily:"Righteous",color:e.palette.primary.dark},List:{width:"80%"}}})),Pc=function(){var e=Fc(),t=Object(l.c)((function(e){return e.general})),a=t.lookedBy,c=t.likedBy,i=t.matches,o=Object(l.c)((function(e){return e.users})).users,u=Object(n.useState)([]),m=Object(s.a)(u,2),d=m[0],f=m[1],p=Object(n.useState)([]),g=Object(s.a)(p,2),h=g[0],b=g[1],v=Object(n.useState)([]),E=Object(s.a)(v,2),y=E[0],x=E[1];return Object(n.useEffect)((function(){if(a&&a.length){var e=a.map((function(e){return o.find((function(t){return t.id===e}))}));f(e)}}),[o,a]),Object(n.useEffect)((function(){if(c&&c.length){var e=c.map((function(e){return o.find((function(t){return t.id===e}))}));b(e)}}),[o,c]),Object(n.useEffect)((function(){if(i&&i.length){var e=i.map((function(e){return o.find((function(t){return t.id===e}))}));x(e)}}),[o,i]),r.a.createElement(j.a,{container:!0,alignItems:"center",direction:"column",className:e.root},r.a.createElement(j.a,{container:!0,direction:"column",alignItems:"center",wrap:"nowrap",className:e.List},r.a.createElement(Pa.a,{variant:"h2",className:e.Header},"People, who looked me"),r.a.createElement($r,{items:d,defaultText:"No one visited you"})),r.a.createElement(j.a,{container:!0,direction:"column",alignItems:"center",wrap:"nowrap",className:e.List},r.a.createElement(Pa.a,{variant:"h2",className:e.Header},"People, who liked me"),r.a.createElement($r,{items:h,defaultText:"No one liked you"})),r.a.createElement(j.a,{container:!0,direction:"column",alignItems:"center",wrap:"nowrap",className:e.List},r.a.createElement(Pa.a,{variant:"h2",className:e.Header},"People, who matched with me"),r.a.createElement($r,{items:y,defaultText:"No one liked you"})))},Rc=Object(d.a)({root:{minWidth:500},selectedTab:{color:"red"},AppBar:{position:"fixed",left:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",minWidth:500},View:{display:"flex",justifyContent:"center",alignItems:"center"},Max:{width:"100%",height:"100vh"},Container:{paddingTop:"70px",backgroundColor:g,maxWidth:"100vw",width:"100%"},Tab:{minWidth:100}}),Wc=[{index:0,label:"Strangers",icon:r.a.createElement(En.a,null),content:r.a.createElement(Ar,null),url:"/"},{index:1,label:"Chat",icon:r.a.createElement(yn.a,null),content:r.a.createElement(Bc,null),url:"/chat"},{index:2,label:"Social",icon:r.a.createElement(xn.a,null),content:r.a.createElement(Pc,null),url:"/social"},{index:3,label:"Settings",icon:r.a.createElement(On.a,null),content:r.a.createElement(mc,null),url:"/profile"},{index:4,label:"Logout",icon:r.a.createElement(jn.a,null),content:null,url:"/logout"}],_c=Object(u.i)((function(){var e=ta().notif,t=Object(l.c)((function(e){return e.UI})),a=t.header,c=t.selectedTab,i=t.companion,s=Object(l.c)((function(e){return e.general})).isLoading,m=Object(l.b)(),d=Object(u.g)(),f=Rc(),p=aa().getChatsInfo;oa();var g=function(){var t=Object(O.a)(x.a.mark((function t(a,n){var r;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("/logout"!==n){t.next=4;break}return m(ka(e)),d.push("/login"),t.abrupt("return");case 4:r=Wc.find((function(e){return e.url===n})),m(pe({header:r.label})),m(he({companion:null})),m(fe({selectedTab:r})),m(Q(null)),m(ve({parent:n.substr(1)})),d.push(n);case 11:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();Object(n.useEffect)((function(){p()}),[]);var h=Wc.map((function(e){return r.a.createElement(gn.a,{icon:e.icon,value:e.url,key:e.index,component:o.b,to:e.url,className:f.Tab})}));return r.a.createElement(hn.a,{className:f.root},s?r.a.createElement(j.a,{container:!0,justify:"center",alignItems:"center",className:f.Max},r.a.createElement(w.a,null)):r.a.createElement(j.a,{container:!0,direction:"column",justify:"flex-start",alignItems:"stretch",spacing:1,className:f.Container},r.a.createElement(yc,{header:(null===i||void 0===i?void 0:i.username)||a||Wc[0].label}),r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/chat",component:Bc}),r.a.createElement(u.b,{path:"/profile",component:mc}),r.a.createElement(u.b,{path:"/social",component:Pc}),r.a.createElement(u.b,{path:"/",component:Ar})),r.a.createElement(bn.a,{className:f.AppBar,position:"static"},r.a.createElement(vn.a,{value:(null===c||void 0===c?void 0:c.url)||"/",centered:!0,onChange:g},h))))})),zc=a(61),Gc=a(373),Hc=a(359),$c=a(369),Kc=function(){return r.a.createElement(hn.a,null,r.a.createElement(j.a,{container:!0,direction:"column",justify:"center",alignItems:"center"},r.a.createElement(Pa.a,null,"There's some info missing about you"),r.a.createElement(Pa.a,null,"Please take a quick survey")))},qc=function(){var e=Object(l.b)(),t=Object(_.a)({},Object(l.c)((function(e){return e.additional}))),a=[{name:"username",type:"text",label:"Username",value:t.username,ignoreUntouched:!0,onChange:function(t){e(Me(t.target.value))},onValidate:function(t){e(Ze(t))},rules:{helperText:"Use letters, numbers or symbols ., %, _, -, +. Min length 3",rule:{minLength:3,maxLength:20,regex:/^[\w%-+.]+$/}}},{name:"name",type:"text",label:"First name",value:t.name,onChange:function(t){e(Be(t.target.value))},onValidate:function(t){e(Xe(t))},rules:{helperText:"Use letters, numbers or symbols ., -. Min length 2",rule:{minLength:2,maxLength:20,regex:/^[\w-.]+$/}}},{name:"surname",type:"text",label:"Last name",value:t.surname,onChange:function(t){e(Fe(t.target.value))},onValidate:function(t){e(Qe(t))},rules:{helperText:"Use letters, numbers or symbols ., -. Min length 2",rule:{minLength:2,maxLength:20,regex:/^[\w-.]+$/}}},{name:"birthDate",type:"date",label:"Birth date",value:t.birthDate,onChange:function(t){e(Re(t.target.value))}},{name:"gender",type:"radio",label:"I'm",values:["male","female"],value:t.gender,onChange:function(t){e(We(t.target.value))}}];return r.a.createElement(Ya,{inputs:a})},Yc=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.additional})),a=[{name:"phone",type:"text",label:"Phone",value:t.phone,ignoreUntouched:!0,inputProps:{autoFocus:!0},onChange:function(t){e(_e(t.target.value))},onValidate:function(t){e(tt(t))},rules:{helperText:"invalid phone",rule:{minLength:0,maxLength:12,regex:/^$|^\+?\d+$/}}},{name:"country",type:"text",label:"Country",value:t.country,onChange:function(t){e(ze(t.target.value))},onValidate:function(t){e(at(t))},rules:{helperText:"Use letters, numbers or symbols ., -. Min length 2",rule:{minLength:2,maxLength:20,regex:/^[\w-.]+$/}}},{name:"city",type:"text",label:"City",value:t.city,onChange:function(t){e(Ge(t.target.value))},onValidate:function(t){e(nt(t))},rules:{helperText:"Use letters, numbers or symbols ., -. Min length 2",rule:{minLength:2,maxLength:20,regex:/^[\w-.]+$/}}},{name:"bio",type:"text",label:"Bio",value:t.bio,ignoreUntouched:!0,inputProps:{autoFocus:!0},onChange:function(t){e(Pe(t.target.value))},onValidate:function(t){e(et(t))},rules:{helperText:"invalid phone",rule:{minLength:2,maxLength:256,regex:/^.+$/}}}];return r.a.createElement(Ya,{inputs:a})},Jc=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.additional})),a=t.lookFor,n=t.maxAge,c=t.minAge,i=[{name:"lookFor",type:"radio",label:"I look for",values:["male","female","both"],value:a,onChange:function(t){e($e(t.target.value))}},{name:"maxDistance",type:"slider",label:"Search distance, km",step:10,min:10,max:1e4,value:t.maxDist,onChange:function(t){e(He(t))}},{name:"ageRange",type:"slider",label:"Age search range",value:[c,n],onChange:function(t){e(Ke(t))}}];return r.a.createElement(Ya,{inputs:i})},Zc=Object(d.a)({Grid:{height:"100vh"},Stepper:{backgroundColor:"#ffffff00"},Buttons:{width:"100%"}}),Xc=[{key:0,view:r.a.createElement(Kc,null),text:"Intro"},{key:1,view:r.a.createElement(qc,null),text:"Who are you?"},{key:2,view:r.a.createElement(Yc,null),text:"Where are you?"},{key:3,view:r.a.createElement(Jc,null),text:"Who fits you?"}],Qc=function(){var e=Zc(),t=Object(n.useState)(0),a=Object(s.a)(t,2),c=a[0],i=a[1],o=ta().notif,m=Object(u.g)(),d=Object(l.b)(),f=Object(l.c)((function(e){return e.additional})),p=Object(_.a)({},f),g=p.id,h=p.name,b=p.surname,v=p.username,E=p.birthDate,y=p.phone,x=p.gender,O=p.country,w=p.city,C=p.maxDist,S=p.lookFor,N=p.minAge,T=p.maxAge,A=p.updateSuccess,L=Object(l.c)((function(e){return e.general.isLoading}));return r.a.createElement(j.a,{container:!0,justify:"center",alignItems:"center"},r.a.createElement(j.a,{item:!0,xs:12,sm:6,lg:4,container:!0,direction:"column",justify:"center",alignItems:"center",className:e.Grid},Xc[c].view,r.a.createElement(Gc.a,{className:e.Stepper,activeStep:c,alternativeLabel:!0},Xc.map((function(e){var t=e.key,a=e.text;return r.a.createElement(Hc.a,{key:t},r.a.createElement($c.a,null,a))}))),r.a.createElement(j.a,{container:!0,justify:"space-evenly",className:e.Buttons},r.a.createElement(k.a,{disabled:L||0===c,onClick:function(){i((function(e){return e-1}))},variant:"outlined"},"Back"),r.a.createElement(k.a,{variant:"contained",color:"primary",onClick:function(){if(c===Xc.length-1){console.log("[AdditionalInfo] updateSuccess before dispatch",A);var e={id:g,name:h,surname:b,username:v,birthDate:E,phone:y,gender:x,country:O,city:w,maxDist:C,lookFor:S,minAge:N,maxAge:T},t=xa(e);t?o("Please, fill all the fields","error"):(d(it(e,o)),d(be(t)),m.push("/"))}else i((function(e){return e+1}))},disabled:L},c===Xc.length-1?"Finish":"Next"))))},ei=function(){var e=Za(),t=ta().notif,a=Object(n.useState)(""),c=Object(s.a)(a,2),i=c[0],o=c[1],l=Object(n.useState)(!1),m=Object(s.a)(l,2),d=m[0],f=m[1],p=Object(u.g)(),g=[{name:"email",type:"email",label:"Email",value:i,onValidate:function(e){f(e)},onChange:function(e){o(e.target.value)},rules:{helperText:"invalid email",rule:{minLength:3,maxLength:40,regex:/^([\w%+-.]+)@([\w-]+\.)+([\w]{2,})$/i}}}],h=[{component:"button",variant:"contained",type:"submit",text:"send restore password link",size:"large",disabled:!d,onClick:function(e){e.preventDefault();try{F.post("/reset",{email:i}),t("Check your email","info")}catch(e){t("Server error, please try again later","error")}}},{component:"button",text:"back to login",size:"large",onClick:function(){p.push("/login")}}];return r.a.createElement(j.a,{container:!0,direction:"column",alignItems:"center",justify:"center",className:e.SingleForm},r.a.createElement(Ya,{className:e.Form,inputs:g,buttons:h}))},ti=a(360),ai=a(261),ni=a(161),ri=a.n(ni),ci=a(361),ii=function(){var e=Object(O.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://www.cloudflare.com/cdn-cgi/trace").then((function(e){return e.text()})).then((function(e){return e.match(/(?<=(ip=))([\d.]+)/g)[0]})).then((function(e){return fetch("http://ip-api.com/json/".concat(e))})).then((function(e){return e.json()})).then((function(e){return{status:!0,data:{position:{lat:e.lat,lon:e.lon}}}}));case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",{status:!1,data:e.t0});case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),oi=Object(d.a)((function(e){return{root:Object(Ja.a)({},e.breakpoints.up("sm"),{minWidth:"344px !important"}),card:{display:"flex",width:"100%"},default:{backgroundColor:e.palette.grey[800]},prompt:{backgroundColor:e.palette.grey[800],width:550},info:{backgroundColor:e.palette.info.main},success:{backgroundColor:e.palette.success.main},warning:{backgroundColor:e.palette.warning.dark},error:{backgroundColor:e.palette.error.main},header:{display:"block",fontWeight:"bold",color:e.palette.common.white},actionRoot:{padding:"8px 8px 8px 26px"},close:{marginLeft:"auto !important",color:e.palette.common.white},text:{fontSize:"1rem",color:e.palette.common.white}}})),li=r.a.forwardRef((function(e,t){var a=e.id,n=oi(),c=function(){var e=navigator.geolocation,t=Object(l.b)(),a=function(e){var a=e.coords;if(a){var n={position:{lat:a.latitude,lon:a.longitude}};t(ba(n))}},n=function(){var e=Object(O.a)(x.a.mark((function e(a){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ii();case 2:(n=e.sent).status&&t(ba(n.data));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{gps:e,getCurrentLocaion:function(){e.getCurrentPosition(a,n)}}}().getCurrentLocaion,i=Object(zc.c)().closeSnackbar,o=Object(l.b)(),s=Object(l.c)((function(e){return e.snack.notifications})).find((function(e){return e.key===a})),u=Object(_.a)({},s),m=u.text,d=u.variant,f=u.header,p="prompt"===d;return r.a.createElement(zc.a,{ref:t,className:n.root},r.a.createElement(kn.a,{className:Bn()(n.card,n[d])},r.a.createElement(ti.a,{classes:{root:n.actionRoot}},f&&r.a.createElement(Pa.a,{variant:"subtitle2",className:n.header},f,":"),m&&r.a.createElement(Pa.a,{variant:"body1",className:n.text},m)),p&&r.a.createElement(ai.a,{className:n.close,onClick:function(){o(ba({useLocation:!0})),o(Ye(!0)),o(it({useLocation:!0})),c(),i(a)}},r.a.createElement(ci.a,{color:"inherit"})),r.a.createElement(ai.a,{className:n.close,onClick:function(){p&&(o(ba({useLocation:!1})),o(Ye(!1)),o(it({useLocation:!1})),ii()),i(a)}},r.a.createElement(ri.a,{color:"inherit"}))))})),si=[],ui=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.snack.notifications})),a=Object(zc.c)(),r=a.enqueueSnackbar,c=a.closeSnackbar;return Object(n.useEffect)((function(){t.forEach((function(t){var a,n=t.key,i=t.text,o=t.options,l=void 0===o?{}:o,s=t.dismissed;void 0!==s&&s?c(n):si.includes(n)||(r(i,Object(_.a)(Object(_.a)({key:n},l),{},{onClose:function(e,t,a){l.onClose&&l.onClose(e,t,a)},onExited:function(t,a){var n;e(wt({key:a})),n=a,si=si.filter((function(e){return n!==e}))}})),a=n,si=[].concat(Object(D.a)(si),[a]))}))}),[t,r,e,c]),null},mi=Object(d.a)({root:{width:"100vw",height:"100vh"}}),di=function(){var e=mi(),t=Object(u.g)(),a=Object(l.b)(),c=ta().notif,i=Object(u.h)();return Object(n.useEffect)((function(){try{console.log(i);var e=i.search.split("=")[1],n=F("email/verify?key=".concat(e));console.log(n.data),n.data.status?(a(ba({email:n.data.data.email})),a(De({email:n.data.data.email})),c("Email successfully updated","success")):c("Email was not updated","error")}catch(r){}a(Oa()),t.push("/")}),[]),r.a.createElement(j.a,{container:!0,justify:"center",alignItems:"center",className:e.root},"Validating your request, please wait")},fi=Object(d.a)({Grid:{width:"100vw",height:"100vh"},root:{marginBottom:40}});var pi=function(){var e=fi(),t=Object(l.b)(),a=ta().showPrompt,c=Object(l.c)((function(e){return e.general})),i=c.isAuth,o=c.isLoading,d=Object(l.c)((function(e){return e.UI})).isInfoMissing,p=Object(n.useState)(r.a.createElement(w.a,null)),g=Object(s.a)(p,2),h=g[0],b=g[1];return Object(n.useEffect)((function(){t(Oa()),navigator.permissions.query({name:"geolocation"}).then((function(e){console.log(e),"granted"===e.state?(t(ba({useLocation:!0})),t(Ye(!0)),t(it())):"prompt"===e.state?a("We use geolocation on this site to provide better results and optimize your experience. Allow using GPS?"):(t(ba({useLocation:!1})),t(Ye(!1)),t(it()),ii())}))}),[]),Object(n.useEffect)((function(){b(o?r.a.createElement(j.a,{container:!0,justify:"center",alignItems:"center",className:e.Grid},r.a.createElement(w.a,null)):i&&d?r.a.createElement(u.d,null,r.a.createElement(u.a,{from:"/login",to:"/add"}),r.a.createElement(u.b,{path:"/add",component:Qc,exact:!0})):i?r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/reset",component:Jr,exact:!0}),r.a.createElement(u.b,{path:"/email/verify",component:di,exact:!0}),r.a.createElement(u.a,{exact:!0,from:"/strangers",to:"/"}),r.a.createElement(u.a,{from:"/login",to:"/"}),r.a.createElement(u.b,{path:"/",component:_c})):r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/email/verify",component:di,exact:!0}),r.a.createElement(u.b,{path:"/login",component:Xa,exact:!0}),r.a.createElement(u.b,{path:"/register",component:pn,exact:!0}),r.a.createElement(u.b,{path:"/forgot",component:ei,exact:!0}),r.a.createElement(u.b,{path:"/reset",component:Jr,exact:!0}),r.a.createElement(u.b,{path:"/"},r.a.createElement(u.a,{to:"/login"}))))}),[i,o,e.Grid,d]),r.a.createElement(f.a,{theme:E},r.a.createElement(zc.b,{maxSnack:3,classes:{containerRoot:e.root},content:function(e){return r.a.createElement(li,{id:e})}},r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a,null),h,r.a.createElement(ui,null))))},gi=a(35),hi=Object(gi.d)({general:Ca,login:U,register:fn,UI:Oe,filter:Te,additional:ot,users:ea,chat:oe,snack:kt,WS:It}),bi=a(80),vi=Object(C.configureStore)({reducer:hi,middleware:[bi.a]});i.a.render(r.a.createElement(l.a,{store:vi},r.a.createElement(o.a,null,r.a.createElement(pi,null))),document.getElementById("root"))},31:function(e,t,a){e.exports=a.p+"static/media/default-avatar.d2c893f5.png"}},[[178,1,2]]]);
//# sourceMappingURL=main.681439f6.chunk.js.map